import{e as T,i as F,A as L,av as G,a2 as j,a3 as q,b as J,d as Y}from"./index-2048a34f.js";import{o as K,a as Q,O as Z,W as ee,N as h,G as te,i as se,b as D,w as ne,ar as oe,d as ae,y as ie,h as I,U as ce}from"./base-d79f9f62.js";import{t as le}from"./error-78e43d3e.js";import{a as re}from"./scroll-aa5f3aa0.js";import{P as w}from"./vnode-772b0c47.js";const Ie=(e,t,s)=>{let n={offsetX:0,offsetY:0};const o=r=>{const u=r.clientX,p=r.clientY,{offsetX:y,offsetY:g}=n,d=e.value.getBoundingClientRect(),b=d.left,k=d.top,X=d.width,z=d.height,O=document.documentElement.clientWidth,N=document.documentElement.clientHeight,A=-b+y,V=-k+g,$=O-b-X+y,U=N-k-z+g,M=x=>{const S=Math.min(Math.max(y+x.clientX-u,A),$),C=Math.min(Math.max(g+x.clientY-p,V),U);n={offsetX:S,offsetY:C},e.value.style.transform=`translate(${T(S)}, ${T(C)})`},_=()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",_)};document.addEventListener("mousemove",M),document.addEventListener("mouseup",_)},i=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",o)},a=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",o)};K(()=>{Q(()=>{s.value?i():a()})}),Z(()=>{a()})};let ue;function fe(e,t=ue){t&&t.active&&t.effects.push(e)}const de=e=>{const t=new Set(e);return t.w=0,t.n=0,t},P=e=>(e.w&l)>0,H=e=>(e.n&l)>0,he=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=l},me=e=>{const{deps:t}=e;if(t.length){let s=0;for(let n=0;n<t.length;n++){const o=t[n];P(o)&&!H(o)?o.delete(e):t[s++]=o,o.w&=~l,o.n&=~l}t.length=s}};let f=0,l=1;const E=30;let c;class ve{constructor(t,s=null,n){this.fn=t,this.scheduler=s,this.active=!0,this.deps=[],this.parent=void 0,fe(this,n)}run(){if(!this.active)return this.fn();let t=c,s=m;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=c,c=this,m=!0,l=1<<++f,f<=E?he(this):R(this),this.fn()}finally{f<=E&&me(this),l=1<<--f,c=this.parent,m=s,this.parent=void 0,this.deferStop&&this.stop()}}stop(){c===this?this.deferStop=!0:this.active&&(R(this),this.onStop&&this.onStop(),this.active=!1)}}function R(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}let m=!0;function pe(e,t){let s=!1;f<=E?H(e)||(e.n|=l,s=!P(e)):s=!e.has(c),s&&(e.add(c),c.deps.push(e))}function ye(e,t){const s=te(e)?e:[...e];for(const n of s)n.computed&&B(n);for(const n of s)n.computed||B(n)}function B(e,t){(e!==c||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}function v(e){const t=e&&e.__v_raw;return t?v(t):e}function ge(e){m&&c&&(e=v(e),pe(e.dep||(e.dep=de())))}function we(e,t){e=v(e);const s=e.dep;s&&ye(s)}var W;class Ee{constructor(t,s,n,o){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this[W]=!1,this._dirty=!0,this.effect=new ve(t,()=>{this._dirty||(this._dirty=!0,we(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=n}get value(){const t=v(this);return ge(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}W="__v_isReadonly";function be(e,t,s=!1){let n,o;const i=ee(e);return i?(n=e,o=h):(n=e.get,o=e.set),new Ee(n,o,i||!o,s)}const Re=e=>{se(e)||le("[useLockscreen]","You need to pass a ref param to this function");const t=D("popup"),s=be(()=>t.bm("parent","hidden"));if(!F||L(document.body,s.value))return;let n=0,o=!1,i="0";const a=()=>{setTimeout(()=>{q(document.body,s.value),o&&(document.body.style.width=i)},200)};ne(e,r=>{if(!r){a();return}o=!L(document.body,s.value),o&&(i=document.body.style.width),n=re(t.namespace.value);const u=document.documentElement.clientHeight<document.body.scrollHeight,p=G(document.body,"overflowY");n>0&&(u||p==="scroll")&&o&&(document.body.style.width=`calc(100% - ${n}px)`),j(document.body,s.value)}),oe(()=>a())},ke=e=>{if(!e)return{onClick:h,onMousedown:h,onMouseup:h};let t=!1,s=!1;return{onClick:a=>{t&&s&&e(a),t=s=!1},onMousedown:a=>{t=a.target===a.currentTarget},onMouseup:a=>{s=a.target===a.currentTarget}}},Me=J({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:Y([String,Array,Object])},zIndex:{type:Y([String,Number])}}),_e={click:e=>e instanceof MouseEvent};var xe=ae({name:"ElOverlay",props:Me,emits:_e,setup(e,{slots:t,emit:s}){const n=D("overlay"),o=u=>{s("click",u)},{onClick:i,onMousedown:a,onMouseup:r}=ke(e.customMaskEvent?void 0:o);return()=>e.mask?ie("div",{class:[n.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:i,onMousedown:a,onMouseup:r},[I(t,"default")],w.STYLE|w.CLASS|w.PROPS,["onClick","onMouseup","onMousedown"]):ce("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[I(t,"default")])}});const Be=xe;export{Be as E,Re as a,ke as b,Ie as u};
