import{d as C,r as f,R as L,c as V,e as n,v as c,x as i,g as T,y as d,i as P,A as x,B as E,u as o,Q as Y,f as G,F as H,z as O,H as w}from"./base-04829be5.js";/* empty css                   *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                  */import{t as l}from"./index-043d021e.js";import{n as j,o as A,p as M,q as z}from"./site-be3599ef.js";import{E as Q}from"./index-db9b8d96.js";import{a as $,E as J}from"./index-6bd50bb5.js";import{a as K,E as W}from"./index-02bf3820.js";import{E as X}from"./index-0515f627.js";import{E as Z}from"./index-eb678249.js";import{E as ee}from"./index-b1557f8a.js";import{v as le}from"./directive-013f0a4e.js";const ae={class:"dialog-footer"},De=C({__name:"edit-site",emits:["complete"],setup(re,{expose:y,emit:D}){let u=f(!1);const s=f(!0);let _=f([]);const v={site_id:"",site_name:"",real_name:"",username:"",password:"",confirm_password:"",expire_time:"",group_id:""},a=L({...v}),b=f();(async()=>{_.value=await(await j({})).data,_.value.length>0&&(a.group_id=_.value[0].group_id)})();const k=async(m=null)=>{if(s.value=!0,Object.assign(a,v),m){const e=await(await A(m.site_id)).data;Object.keys(a).forEach(t=>{e[t]!=null&&(a[t]=e[t])})}s.value=!1},q=V(()=>({site_name:[{required:!0,message:l("siteNamePlaceholder"),trigger:"blur"}],group_id:[{required:!0,message:l("groupIdPlaceholder"),trigger:"blur"}],username:[{required:!0,message:l("usernamePlaceholder"),trigger:"blur"}],password:[{required:!0,message:l("passwordPlaceholder"),trigger:"blur"}],real_name:[{required:!0,message:l("userRealNamePlaceholder"),trigger:"blur"}],confirm_password:[{required:!0,message:l("confirmPasswordPlaceholder"),trigger:"blur"},{validator:(m,e,t)=>{e!=a.password?t(new Error(l("confirmPasswordError"))):t()},trigger:"blur"}],expire_time:[{required:!0,message:l("expireTimePlaceholder"),trigger:"blur"}]})),N=V(()=>(f(""),s.value?"":a.site_id?l("editSite"):l("addSite"))),S=async m=>{s.value||!m||await m.validate(async e=>{if(e){s.value=!0;let t=a;(t.site_id?M:z)(t).then(g=>{s.value=!1,u.value=!1,D("complete")}).catch(g=>{s.value=!1})}})};return y({showDialog:u,setFormData:k,loading:s}),(m,e)=>{const t=Q,p=$,g=K,U=W,B=X,F=J,h=Z,I=ee,R=le;return n(),c(I,{modelValue:o(u),"onUpdate:modelValue":e[8]||(e[8]=r=>P(u)?u.value=r:u=r),title:o(N),width:"500px","destroy-on-close":!0},{footer:i(()=>[T("span",ae,[d(h,{onClick:e[6]||(e[6]=r=>P(u)?u.value=!1:u=!1)},{default:i(()=>[x(E(o(l)("cancel")),1)]),_:1}),d(h,{type:"primary",loading:s.value,onClick:e[7]||(e[7]=r=>S(b.value))},{default:i(()=>[x(E(o(l)("confirm")),1)]),_:1},8,["loading"])])]),default:i(()=>[Y((n(),c(F,{model:a,"label-width":"90px",ref_key:"formRef",ref:b,rules:o(q),class:"page-form"},{default:i(()=>[d(p,{label:o(l)("siteName"),prop:"site_name"},{default:i(()=>[d(t,{modelValue:a.site_name,"onUpdate:modelValue":e[0]||(e[0]=r=>a.site_name=r),clearable:"",placeholder:o(l)("siteNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(p,{label:o(l)("groupId"),prop:"group_id"},{default:i(()=>[d(U,{modelValue:a.group_id,"onUpdate:modelValue":e[1]||(e[1]=r=>a.group_id=r),clearable:"",placeholder:o(l)("groupIdPlaceholder"),class:"input-width"},{default:i(()=>[(n(!0),G(H,null,O(o(_),r=>(n(),c(g,{label:r.group_name,value:r.group_id},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),!a.site_id&&!s.value?(n(),c(p,{key:0,label:o(l)("username"),prop:"username"},{default:i(()=>[d(t,{modelValue:a.username,"onUpdate:modelValue":e[2]||(e[2]=r=>a.username=r),clearable:"",placeholder:o(l)("usernamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),!a.site_id&&!s.value?(n(),c(p,{key:1,label:o(l)("password"),prop:"password"},{default:i(()=>[d(t,{modelValue:a.password,"onUpdate:modelValue":e[3]||(e[3]=r=>a.password=r),clearable:"",placeholder:o(l)("passwordPlaceholder"),class:"input-width","show-password":!0,type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),!a.site_id&&!s.value?(n(),c(p,{key:2,label:o(l)("confirmPassword"),prop:"confirm_password"},{default:i(()=>[d(t,{modelValue:a.confirm_password,"onUpdate:modelValue":e[4]||(e[4]=r=>a.confirm_password=r),placeholder:o(l)("confirmPasswordPlaceholder"),type:"password","show-password":!0,clearable:"",class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),d(p,{label:o(l)("expireTime"),prop:"expire_time",class:"input-width"},{default:i(()=>[d(B,{class:"flex-1 !flex",modelValue:a.expire_time,"onUpdate:modelValue":e[5]||(e[5]=r=>a.expire_time=r),clearable:"",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:o(l)("expireTimePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[R,s.value]])]),_:1},8,["modelValue","title"])}}});export{De as _};
