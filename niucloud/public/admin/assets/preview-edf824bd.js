import{d as R,r,O as W,n as z,aL as M,s as O,a4 as h,N as a,h as b,c as B,y as m,z as _,a as o,t as i,u as l,e as s,w as n,i as N,I as S,R as X,B as Y,U as j,W as A,E as G,X as H,V as J,Y as K}from"./index-9d601459.js";/* empty css                *//* empty css                 *//* empty css                        */import"./el-form-item-4ed993c7.js";/* empty css                  *//* empty css                 */import{g as Q}from"./weapp-37d6496a.js";import{m as Z}from"./sys-45a56363.js";import{b as ee}from"./browser-a1ac24ac.js";import{l as ae}from"./diy-7134d17c.js";const te={class:"main-container w-[375px] mx-auto my-[20px] relative"},oe={class:"flex h-full"},le=["src"],se={class:"w-[375px] border border-slate-100 bg-body pt-[20px] px-[20px]"},re={class:"font-bold text-xl mb-[40px]"},ne={class:"mb-[20px] flex flex-col"},pe={class:"mb-[10px]"},ie={key:0,class:"w-[400px] absolute bg-body top-[10%] -right-[450px]"},ce={class:"info-wrap mt-[20px]"},de={class:"px-[20px] pb-[10px] font-bold"},ue={class:"px-[20px] pb-[10px] font-bold mt-[40px]"},me={class:"text-gray-400"},Ce=R({__name:"preview",setup(_e){const v=r(""),d=r(""),f=r(""),p=r(""),D=r(!1),u=r(!1),x=r(!1),L=r(0);new Date().getTime();const c=W();c.query.id=c.query.id||0,c.query.name=c.query.name||"",Z().then(e=>{d.value=e.data.wap_domain,v.value=e.data.wap_url,q()});const T=()=>{if(d.value.trim().length==0){h({type:"warning",message:`${a("wapDomainPlaceholder")}`});return}v.value=d.value+"/wap",q(),j.set({key:"wap_domain",data:v.value}),u.value=!0,x.value=!1},q=()=>{ae({id:c.query.id,name:c.query.name}).then(e=>{let t=e.data;p.value=`${v.value}/${t.page}`,ee.toDataURL(p.value,{errorCorrectionLevel:"L",margin:0,width:100}).then(w=>{f.value=w})})},U=()=>{if(p.value){var e=new Date().getTime(),t=e-L.value;t<1e3?(x.value=!0,u.value=!1,p.value="",f.value=""):(x.value=!1,u.value=!0),D.value=!0}},y=z({qr_code:""});r("weapp"),Q().then(e=>{if(e.code==1){let t=e.data;y.qr_code=t.qr_code}});const{copy:P,isSupported:$,copied:k}=M(),F=e=>{$.value||h({message:a("notSupportCopy"),type:"warning"}),P(e)};return O(k,()=>{k.value&&h({message:a("copySuccess"),type:"success"})}),(e,t)=>{const w=A,C=G,g=H,E=J,I=K;return b(),B("div",te,[m(o("div",oe,[m(o("iframe",{class:"w-[375px] border border-slate-100 bg-gray-100",src:p.value,frameborder:"0",id:"previewIframe",onLoad:U},null,40,le),[[_,u.value]]),m(o("div",se,[o("div",re,i(l(a)("developTitle")),1),o("div",ne,[o("text",pe,i(l(a)("wapDomain")),1),s(w,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=V=>d.value=V),placeholder:l(a)("wapDomainPlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),s(C,{type:"primary",onClick:T},{default:n(()=>[N(i(l(a)("confirm")),1)]),_:1})],512),[[_,x.value]]),u.value?(b(),B("div",ie,[o("div",ce,[o("div",de,i(l(a)("h5")),1),s(I,{"label-width":"40px",class:"px-[20px]"},{default:n(()=>[m(s(g,{label:l(a)("link")},{default:n(()=>[s(w,{readonly:"",value:p.value},{append:n(()=>[s(C,{onClick:t[1]||(t[1]=V=>F(p.value)),class:"bg-primary copy"},{default:n(()=>[N(i(l(a)("copy")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),[[_,p.value]]),m(s(g,{label:" "},{default:n(()=>[s(E,{src:f.value},null,8,["src"])]),_:1},512),[[_,f.value]])]),_:1}),o("div",ue,i(l(a)("weapp")),1),s(I,{"label-width":"40px",class:"px-[20px]"},{default:n(()=>[y.qr_code?(b(),S(g,{key:0,label:" "},{default:n(()=>[s(E,{class:"w-[100px] h-[100px]",src:l(X)(y.qr_code)},null,8,["src"])]),_:1})):(b(),S(g,{key:1,label:" "},{default:n(()=>[o("span",me,i(l(a)("weappNotSet")),1)]),_:1}))]),_:1})])])):Y("",!0)],512),[[_,D.value]])])}}});export{Ce as default};
