import"./base-962c0c23.js";/* empty css                   */import{E as F}from"./el-overlay-60700377.js";/* empty css                  *//* empty css                     *//* empty css                 */import{t as l}from"./index-105fbad0.js";import{p as B,q as $,r as H}from"./member-21f99754.js";import{E as I}from"./index-93f2c618.js";import{a as L,E as R}from"./index-61c777fa.js";import{E as j}from"./index-bba9e58c.js";import{v as O}from"./directive-c0c3e9a3.js";import{d as T,r as b,M as z,c as A,b as v,m as h,p as d,f as S,q as s,v as V,x as y,u as r,L as Z}from"./runtime-core.esm-bundler-dc7a07d7.js";const G={class:"dialog-footer"},ie=T({__name:"add-member",emits:["complete"],setup(J,{expose:N,emit:E}){const p=b(!1),i=b(!1);let u="",c="";const f={member_id:"",nickname:"",member_no:"",init_member_no:"",mobile:"",password:"",password_copy:""},a=z({...f}),_=b(),P=A(()=>({member_no:[{required:!0,message:l("memberNoPlaceholder"),trigger:"blur"},{validator:C,trigger:"blur"}],mobile:[{required:!0,message:l("mobilePlaceholder"),trigger:"blur"},{validator:x,trigger:"blur"}],password:[{required:!0,message:l("passwordPlaceholder"),trigger:"blur"}],password_copy:[{required:!0,message:l("passwordPlaceholder"),trigger:"blur"},{validator:D,trigger:"blur"}]})),x=(m,e,o)=>{e&&!/^1[3-9]\d{9}$/.test(e)?o(new Error(l("mobileHint"))):o()},D=(m,e,o)=>{e!=a.password?o(l("doubleCipherHint")):o()},C=(m,e,o)=>{e&&!/^[0-9a-zA-Z]*$/g.test(e)?o(new Error(l("memberNoHint"))):o()},k=async()=>{await $().then(m=>{c=m.data}).catch(()=>{})},q=async m=>{if(i.value||!m)return;const e=H;await m.validate(async o=>{o&&(i.value=!0,e(a).then(w=>{i.value=!1,p.value=!1,E("complete")}).catch(()=>{i.value=!1}))})};return N({showDialog:p,setFormData:async(m=null)=>{if(i.value=!0,Object.assign(a,f),u=l("addMember"),m){u=l("updateMember");const e=await(await B(m.member_id)).data;e&&Object.keys(a).forEach(o=>{e[o]!=null&&(a[o]=e[o])})}else await k(),a.member_no=c,a.init_member_no=c;i.value=!1}}),(m,e)=>{const o=I,n=L,w=R,g=j,M=F,U=O;return v(),h(M,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=t=>p.value=t),title:r(u),width:"500px","destroy-on-close":!0},{footer:d(()=>[S("span",G,[s(g,{onClick:e[5]||(e[5]=t=>p.value=!1)},{default:d(()=>[V(y(r(l)("cancel")),1)]),_:1}),s(g,{type:"primary",loading:i.value,onClick:e[6]||(e[6]=t=>q(_.value))},{default:d(()=>[V(y(r(l)("confirm")),1)]),_:1},8,["loading"])])]),default:d(()=>[Z((v(),h(w,{model:a,"label-width":"90px",ref_key:"formRef",ref:_,rules:r(P),class:"page-form"},{default:d(()=>[s(n,{label:r(l)("memberNo"),prop:"member_no"},{default:d(()=>[s(o,{modelValue:a.member_no,"onUpdate:modelValue":e[0]||(e[0]=t=>a.member_no=t),clearable:"",maxlength:"20",placeholder:r(l)("memberNoPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(n,{label:r(l)("mobile"),prop:"mobile"},{default:d(()=>[s(o,{modelValue:a.mobile,"onUpdate:modelValue":e[1]||(e[1]=t=>a.mobile=t),clearable:"",placeholder:r(l)("mobilePlaceholder"),type:"number",class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(n,{label:r(l)("nickname")},{default:d(()=>[s(o,{modelValue:a.nickname,"onUpdate:modelValue":e[2]||(e[2]=t=>a.nickname=t),clearable:"",placeholder:r(l)("nickNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(n,{label:r(l)("password"),prop:"password"},{default:d(()=>[s(o,{modelValue:a.password,"onUpdate:modelValue":e[3]||(e[3]=t=>a.password=t),type:"password",placeholder:r(l)("passwordPlaceholder"),clearable:"",class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(n,{label:r(l)("passwordCopy"),prop:"password_copy"},{default:d(()=>[s(o,{modelValue:a.password_copy,"onUpdate:modelValue":e[4]||(e[4]=t=>a.password_copy=t),type:"password",placeholder:r(l)("passwordPlaceholder"),clearable:"",class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[U,i.value]])]),_:1},8,["modelValue","title"])}}});export{ie as _};
