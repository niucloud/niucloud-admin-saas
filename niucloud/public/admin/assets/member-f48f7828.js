import{d as M,r as _,n as k,f as q,aK as z,s as A,a3 as g,N as o,h as P,c as C,a as s,t as i,y as m,z as d,u as l,e as p,w as n,i as w,R as J,B as E,A as W,U as X,W as Y,E as j,X as H,Y as K,V as Q}from"./index-b19d04dd.js";/* empty css                 *//* empty css                        *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  *//* empty css                 */import{c as G}from"./diy-f74720de.js";import{b as Z}from"./browser-a1ac24ac.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";const te={key:0,class:"flex flex-wrap mt-[20px] min-w-[1000px]"},ae={class:"page-item relative bg-no-repeat ml-[20px] mr-[40px] bg-[#f7f7f7] w-[340px] pt-[90px] pb-[20px]"},se={class:"absolute top-[54px] left-[50%] translate-x-[-50%] text-[14px] truncate w-[130px] text-center"},oe={class:"w-[320px] h-[550px] mx-auto"},le=["id","src"],ie={class:"w-[320px] h-[550px] mx-auto bg-body pt-[20px] px-[20px]"},pe={class:"font-bold text-xl mb-[40px]"},ne={class:"mb-[20px] flex flex-col"},re={class:"mb-[10px]"},me={class:"flex"},de={class:"overflow-hidden w-[320px] h-[550px] mx-auto"},ce=["src"],ue={class:"w-[500px]"},_e={class:"flex flex-wrap"},fe={class:"info-wrap"},ve={class:"mt-[20px] bg-[#F7F8FA] p-[20px] flex items-center justify-between"},we={class:"font-bold"},xe={class:"text-[#999] text-base"},ge={class:"text-center"},ye=M({__name:"member",setup(be){const x=_("DIY_MEMBER_INDEX"),e=k({}),y=q(),c=_(""),b=_(""),u=_({name:""});k({type:"",name:"",parent:"",page:"",title:"",action:""}),(()=>{G({type:x.value}).then(t=>{for(const a in t.data)e[a]=t.data[a];u.value.name=e.use_template.name,u.value.title=e.use_template.title,u.value.page=e.use_template.page,u.value.action=e.use_template.action,u.value.parent=e.use_template.parent,e.use_template.url&&(e.loadingIframe=!1,e.loadingDev=!1,e.isDisabledPop=!1,e.difference=0,c.value=e.domain_url.wap_domain,e.wapUrl=e.domain_url.wap_url,D())})})(),window.addEventListener("message",t=>{try{const a=JSON.parse(t.data);if(["appOnLaunch","appOnReady"].indexOf(a.type)!=-1){e.loadingDev=!1,e.loadingIframe=!0;const f=new Date().getTime();e.difference=f-e.timeIframe,e.isDisabledPop=!1}}catch(a){h(),console.log("后台接受数据错误",a)}},!1);const T=()=>{const t=JSON.stringify({type:"appOnReady",message:"加载完成"});window["previewIframe_"+x.value]&&window["previewIframe_"+x.value].contentWindow.postMessage(t,"*")},h=()=>{e.loadingDev=!0,e.isDisabledPop=!0,e.loadingIframe=!1},N=()=>{if(c.value.trim().length==0){g({type:"warning",message:`${o("wapDomainPlaceholder")}`});return}const t=c.value+"/wap";X.set({key:"wap_domain",data:t}),e.use_template.url&&(e.wapUrl=t,D()),setTimeout(()=>{e.use_template.url&&(e.loadingIframe=!0,e.loadingDev=!1,e.isDisabledPop=!1)},100*3)},R=()=>{window.open("https://www.kancloud.cn/niucloud/niucloud-admin-develop/3213393")},D=()=>{e.use_template.wapPreview=e.wapUrl+e.use_template.url,Z.toDataURL(e.use_template.wapPreview,{errorCorrectionLevel:"L",margin:0,width:100}).then(t=>{b.value=t}),e.timeIframe=new Date().getTime(),T(),setTimeout(()=>{e.difference==0&&h()},1e3*2)},V=()=>{const t={back:"/site/diy/member"};e.use_template.id?t.id=e.use_template.id:e.use_template.type?t.name=e.use_template.type:e.use_template.url&&(t.url=e.use_template.url);const a=y.resolve({path:"/decorate/edit",query:t});window.open(a.href)},O=()=>{let t=e.use_template.page;e.use_template.url?t=e.use_template.url:e.use_template.id&&(t+="?id="+e.use_template.id);const a=y.resolve({path:"/preview/wap",query:{page:t}});window.open(a.href)};_(!1);const{copy:S,isSupported:U,copied:I}=z(),B=t=>{U.value||g({message:o("notSupportCopy"),type:"warning"}),S(t)};return A(I,()=>{I.value&&g({message:o("copySuccess"),type:"success"})}),(t,a)=>{const f=Y,v=j,L=H,$=K,F=Q;return e.use_template?(P(),C("div",te,[s("div",ae,[s("p",se,i(e.use_template.title),1),m(s("div",oe,[m(s("iframe",{id:"previewIframe_"+t.key,class:"w-[320px] h-[550px] mx-auto",src:e.use_template.wapPreview,frameborder:"0"},null,8,le),[[d,e.loadingIframe]]),m(s("div",ie,[s("div",pe,i(l(o)("developTitle")),1),s("div",ne,[s("text",re,i(l(o)("wapDomain")),1),p(f,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=r=>c.value=r),placeholder:l(o)("wapDomainPlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),s("div",me,[p(v,{type:"primary",onClick:a[1]||(a[1]=r=>N())},{default:n(()=>[w(i(l(o)("confirm")),1)]),_:1}),p(v,{type:"primary",onClick:a[2]||(a[2]=r=>R()),plain:""},{default:n(()=>[w(i(l(o)("settingTips")),1)]),_:1})])],512),[[d,e.loadingDev]])],512),[[d,e.use_template.url]]),m(s("div",de,[e.use_template.cover?(P(),C("img",{key:0,class:"max-w-full",src:l(J)(e.use_template.cover)},null,8,ce)):E("",!0)],512),[[d,!e.use_template.wapPreview]]),s("div",{class:W(["popup-wrap absolute inset-x-0 inset-y-0 select-none",{disabled:e.isDisabledPop}])},null,2)]),s("div",ue,[s("div",_e,[m(p(v,{type:"primary",onClick:a[3]||(a[3]=r=>V()),class:"mr-[12px]"},{default:n(()=>[w(i(l(o)("decorate")),1)]),_:1},512),[[d,e.use_template.action=="decorate"]])]),s("div",fe,[s("div",ve,[s("div",null,[s("div",we,i(l(o)("H5")),1),p($,{"label-width":"40px",class:"mt-[5px]"},{default:n(()=>[m(p(L,{label:l(o)("link"),class:"mb-[5px]"},{default:n(()=>[p(f,{readonly:"",value:e.use_template.wapPreview},{append:n(()=>[p(v,{onClick:a[4]||(a[4]=r=>B(e.use_template.wapPreview)),class:"bg-primary copy"},{default:n(()=>[w(i(l(o)("copy")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),[[d,e.use_template.wapPreview]])]),_:1}),s("div",xe,i(l(o)("scanQRCodeOnRight")),1)]),s("div",ge,[p(F,{class:"w-[100px] h-[100px] mb-[5px]",src:b.value},null,8,["src"]),s("div",{onClick:a[5]||(a[5]=r=>O()),class:"text-primary text-base cursor-pointer"},i(l(o)("preview")),1)])])])])])):E("",!0)}}});const Oe=ee(ye,[["__scopeId","data-v-612859b5"]]);export{Oe as default};
