import{d as j,r as g,R as A,c as L,e as y,v as h,x as u,g as D,y as a,A as p,B as i,u as r,Q as f,H as z,f as G,F as Z,z as H}from"./base-9962c822.js";/* empty css                   *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                        *//* empty css                 */import{_ as Q}from"./index-0c9f12bb.js";/* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 */import"./el-form-item-4ed993c7.js";import{v as c}from"./index-5c4817f4.js";import{t}from"./index-6e46fb55.js";import{_ as J}from"./select-menu-item.vue_vue_type_script_setup_true_lang-fa454072.js";import{j as W,k as X,l as Y}from"./sys-361f7d2c.js";import{E as ee}from"./index-19251c17.js";import{a as le,E as ae}from"./index-7c833df7.js";import{E as te,b as oe}from"./index-13fd1eb5.js";import{a as ue,E as re}from"./index-22970d5d.js";import{E as ne}from"./index-5fc48b46.js";import{E as me}from"./index-7ab57426.js";import{E as de}from"./index-e2acd187.js";import{v as se}from"./directive-f75d4a7d.js";const pe={class:"input-width"},ie={class:"dialog-footer"},Oe=j({__name:"edit-menu",props:{menuTree:{type:Array,default:()=>[]}},emits:["complete"],setup(I,{expose:N,emit:x}){const M=I,b=g(!1),w=g("post"),_=g(!1);let E="";const P={id:0,menu_name:"",menu_type:0,parent_key:"",icon:"",api_url:"",router_path:"",view_path:"",methods:"",sort:"",status:1,is_show:1,menu_key:"",app_type:""},e=A({...P}),k=g(),$=s=>/^([a-zA-Z_$])([a-zA-Z0-9_$])*$/.test(s),B=L(()=>({menu_name:[{required:!0,message:t("menuNamePlaceholder"),trigger:"blur"}],menu_key:[{required:!0,message:t("menuKeyPlaceholder"),trigger:"blur"},{validator:(s,l,n)=>{$(l)||n(new Error(t("menuKeyValidata"))),n()},trigger:"blur"}],router_path:[{required:e.menu_type!=2,message:t("routePathPlaceholder"),trigger:"blur"}],view_path:[{required:e.menu_type==1,message:t("viewPathPlaceholder"),trigger:"blur"}],icon:[{required:e.menu_type!=2,message:t("selectIconPlaceholder"),trigger:"blur"}],api_url:[{required:e.menu_type==2,message:t("selectIconPlaceholder"),trigger:"blur"}]})),F=async s=>{if(_.value||!s)return;const l=e.id?W:X;await s.validate(async(n,m)=>{if(n){_.value=!0;const d=e;d.api_url=d.api_url?`${d.api_url}/${w.value}`:"",l(d).then(V=>{_.value=!1,b.value=!1,x("complete")}).catch(()=>{_.value=!1})}})};return N({showDialog:b,setFormData:async(s=null)=>{if(_.value=!0,Object.assign(e,P),E=t("addMenu"),s.menu_key){E=t("updateMenu");const l=await(await Y(s.menu_key)).data;Object.keys(e).forEach(n=>{l[n]!=null&&(e[n]=l[n])})}else Object.keys(e).forEach(l=>{s[l]!=null&&(e[l]=s[l])});_.value=!1}}),(s,l)=>{const n=ee,m=le,d=te,V=oe,v=ue,U=re,q=Q,R=ne,S=ae,T=me,C=de,K=se;return y(),h(C,{modelValue:b.value,"onUpdate:modelValue":l[14]||(l[14]=o=>b.value=o),title:r(E),width:"500px","destroy-on-close":!0},{footer:u(()=>[D("span",ie,[a(T,{onClick:l[12]||(l[12]=o=>b.value=!1)},{default:u(()=>[p(i(r(t)("cancel")),1)]),_:1}),a(T,{type:"primary",loading:_.value,onClick:l[13]||(l[13]=o=>F(k.value))},{default:u(()=>[p(i(r(t)("confirm")),1)]),_:1},8,["loading"])])]),default:u(()=>[f((y(),h(S,{model:e,"label-width":"90px",class:"page-form",ref_key:"formRef",ref:k,rules:r(B)},{default:u(()=>[a(m,{label:r(t)("menuName"),prop:"menu_name"},{default:u(()=>[a(n,{modelValue:e.menu_name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.menu_name=o),placeholder:r(t)("menuNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e.id?z("",!0):(y(),h(m,{key:0,label:r(t)("menuKey"),prop:"menu_key"},{default:u(()=>[a(n,{modelValue:e.menu_key,"onUpdate:modelValue":l[1]||(l[1]=o=>e.menu_key=o),placeholder:r(t)("menuKeyPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),a(m,{label:r(t)("menuType")},{default:u(()=>[a(V,{modelValue:e.menu_type,"onUpdate:modelValue":l[2]||(l[2]=o=>e.menu_type=o)},{default:u(()=>[a(d,{label:0},{default:u(()=>[p(i(r(t)("menuTypeDir")),1)]),_:1}),a(d,{label:1},{default:u(()=>[p(i(r(t)("menuTypeMenu")),1)]),_:1}),a(d,{label:2},{default:u(()=>[p(i(r(t)("menuTypeButton")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(m,{label:r(t)("parentMenu"),prop:"parent_key"},{default:u(()=>[a(U,{modelValue:e.parent_key,"onUpdate:modelValue":l[3]||(l[3]=o=>e.parent_key=o),placeholder:"Select",class:"input-width"},{default:u(()=>[a(v,{label:r(t)("topLevel"),value:""},null,8,["label"]),(y(!0),G(Z,null,H(M.menuTree,(o,O)=>(y(),h(J,{menu:o,key:O},null,8,["menu"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),f(a(m,{label:r(t)("routePath"),prop:"router_path"},{default:u(()=>[a(n,{modelValue:e.router_path,"onUpdate:modelValue":l[4]||(l[4]=o=>e.router_path=o),placeholder:r(t)("routePathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[c,e.menu_type!=2]]),f(a(m,{label:r(t)("viewPath"),prop:"view_path"},{default:u(()=>[a(n,{modelValue:e.view_path,"onUpdate:modelValue":l[5]||(l[5]=o=>e.view_path=o),placeholder:r(t)("viewPathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[c,e.menu_type==1]]),f(a(m,{label:r(t)("authId"),prop:"api_url"},{default:u(()=>[a(n,{modelValue:e.api_url,"onUpdate:modelValue":l[7]||(l[7]=o=>e.api_url=o),placeholder:r(t)("authIdPlaceholder"),class:"input-width"},{append:u(()=>[a(U,{class:"w-[90px] border-none",modelValue:w.value,"onUpdate:modelValue":l[6]||(l[6]=o=>w.value=o)},{default:u(()=>[a(v,{label:"POST",value:"post"}),a(v,{label:"GET",value:"get"}),a(v,{label:"PUT",value:"put"}),a(v,{label:"DELETE",value:"delete"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),[[c,e.menu_type!=0]]),f(a(m,{label:r(t)("menuIcon"),prop:"icon"},{default:u(()=>[D("div",pe,[a(q,{modelValue:e.icon,"onUpdate:modelValue":l[8]||(l[8]=o=>e.icon=o)},null,8,["modelValue"])])]),_:1},8,["label"]),[[c,e.menu_type!=2]]),f(a(m,{label:r(t)("status")},{default:u(()=>[a(V,{modelValue:e.status,"onUpdate:modelValue":l[9]||(l[9]=o=>e.status=o)},{default:u(()=>[a(d,{label:1},{default:u(()=>[p(i(r(t)("statusNormal")),1)]),_:1}),a(d,{label:0},{default:u(()=>[p(i(r(t)("statusDeactivate")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[c,e.menu_type!=2]]),f(a(m,{label:r(t)("isShow")},{default:u(()=>[a(V,{modelValue:e.is_show,"onUpdate:modelValue":l[10]||(l[10]=o=>e.is_show=o)},{default:u(()=>[a(d,{label:1},{default:u(()=>[p(i(r(t)("show")),1)]),_:1}),a(d,{label:0},{default:u(()=>[p(i(r(t)("hidden")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[c,e.menu_type!=2]]),a(m,{label:r(t)("sort")},{default:u(()=>[a(R,{modelValue:e.sort,"onUpdate:modelValue":l[11]||(l[11]=o=>e.sort=o),min:0},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[K,_.value]])]),_:1},8,["modelValue","title"])}}});export{Oe as _};
