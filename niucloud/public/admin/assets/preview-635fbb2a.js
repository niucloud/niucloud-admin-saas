import{d as P,r as i,R as F,w as A,e as w,f as L,g as a,Q as g,B as n,u as o,y as l,x as s,A as N,v as T,H}from"./base-9962c822.js";/* empty css                *//* empty css                 *//* empty css                        */import"./el-form-item-4ed993c7.js";/* empty css                  *//* empty css                 */import{E as J,v as y}from"./index-5c4817f4.js";import{t as e}from"./index-5516aed6.js";import{u as M}from"./vue-router-d7e63612.js";import{g as Q}from"./weapp-6fcef875.js";import{v as W}from"./sys-7988dced.js";import{f as j,a as z}from"./storage-0874d153.js";import{b as G}from"./browser-a1ac24ac.js";import{a as h}from"./index-2cabf788.js";import{E as K}from"./index-19251c17.js";import{E as X}from"./index-7ab57426.js";import{a as Y,E as Z}from"./index-7c833df7.js";import{E as ee}from"./index-7332c216.js";import"./index-57446bef.js";import"./pinia-a9fc3924.js";import"./index-e026a545.js";import"./system-1108e5c1.js";import"./index-c4e33d8d.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./typescript-defaf979.js";import"./index-c98e204a.js";import"./event-9519ab40.js";import"./index-ec548bfb.js";import"./index-6b77b11a.js";import"./index-71b7d8f4.js";import"./error-78e43d3e.js";import"./index-1370ab44.js";import"./_Uint8Array-c92ffa25.js";import"./_initCloneObject-41dd9efb.js";import"./index-57e03d9e.js";import"./index-df16e899.js";import"./debounce-9674000c.js";import"./position-8e494ab3.js";import"./scroll-d85c8f38.js";const te={class:"main-container w-[375px] mx-auto mt-[20px] mb-[40px] relative"},ae={class:"flex full-container"},oe=["src"],le={class:"w-[375px] border border-slate-100 bg-body pt-[20px] px-[20px]"},se={class:"font-bold text-xl mb-[40px]"},re={class:"mb-[20px] flex flex-col"},pe={class:"mb-[10px]"},ie={key:0,class:"w-[400px] absolute bg-body top-[10%] -right-[450px]"},ne={class:"info-wrap mt-[20px]"},me={class:"px-[20px] pb-[10px] font-bold"},ce={class:"px-[20px] pb-[10px] font-bold mt-[40px]"},ue={class:"text-gray-400"},et=P({__name:"preview",setup(de){const u=i(""),d=i(""),v=i(""),r=i(""),c=i(!1),_=i(!1),E=i(0),D=i(0);new Date().getTime();const f=M();f.query.page=f.query.page||"",W().then(t=>{u.value=t.data.wap_url,k()});const O=()=>{if(d.value.trim().length==0){h({type:"warning",message:`${e("wapDomainPlaceholder")}`});return}u.value=d.value+"/wap",k(),z.set({key:"wap_domain",data:u.value}),c.value=!0,_.value=!1},k=()=>{f.query.page&&(r.value=`${u.value}${f.query.page}`,console.log(r.value),G.toDataURL(r.value,{errorCorrectionLevel:"L",margin:0,width:100}).then(t=>{v.value=t}),E.value=new Date().getTime(),setTimeout(()=>{D.value==0&&C()},1e3*2))};window.addEventListener("message",t=>{try{let m=JSON.parse(t.data);if(["appOnLaunch","appOnReady"].indexOf(m.type)!=-1){_.value=!1,c.value=!0;var p=new Date().getTime();D.value=p-E.value}}catch(m){C(),console.log("后台接受数据错误",m)}},!1);const C=()=>{_.value=!0,c.value=!1,r.value="",v.value=""},b=F({qr_code:""});Q().then(t=>{if(t.code==1){let p=t.data;b.qr_code=p.qr_code}});const{copy:R,isSupported:U,copied:q}=J(),$=t=>{U.value||h({message:e("notSupportCopy"),type:"warning"}),R(t)};return A(q,()=>{q.value&&h({message:e("copySuccess"),type:"success"})}),(t,p)=>{const m=K,I=X,x=Y,S=ee,V=Z;return w(),L("div",te,[a("div",ae,[g(a("iframe",{class:"w-[375px]",src:r.value,frameborder:"0",id:"previewIframe"},null,8,oe),[[y,c.value]]),g(a("div",le,[a("div",se,n(o(e)("developTitle")),1),a("div",re,[a("text",pe,n(o(e)("wapDomain")),1),l(m,{modelValue:d.value,"onUpdate:modelValue":p[0]||(p[0]=B=>d.value=B),placeholder:o(e)("wapDomainPlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),l(I,{type:"primary",onClick:O},{default:s(()=>[N(n(o(e)("confirm")),1)]),_:1})],512),[[y,_.value]]),c.value?(w(),L("div",ie,[a("div",ne,[a("div",me,n(o(e)("h5")),1),l(V,{"label-width":"40px",class:"px-[20px]"},{default:s(()=>[g(l(x,{label:o(e)("link")},{default:s(()=>[l(m,{readonly:"",value:r.value},{append:s(()=>[l(I,{onClick:p[1]||(p[1]=B=>$(r.value)),class:"bg-primary copy"},{default:s(()=>[N(n(o(e)("copy")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),[[y,r.value]]),g(l(x,{label:" "},{default:s(()=>[l(S,{src:v.value},null,8,["src"])]),_:1},512),[[y,v.value]])]),_:1}),a("div",ce,n(o(e)("weapp")),1),l(V,{"label-width":"40px",class:"px-[20px]"},{default:s(()=>[b.qr_code?(w(),T(x,{key:0,label:" "},{default:s(()=>[l(S,{class:"w-[100px] h-[100px]",src:o(j)(b.qr_code)},null,8,["src"])]),_:1})):(w(),T(x,{key:1,label:" "},{default:s(()=>[a("span",ue,n(o(e)("weappNotSet")),1)]),_:1}))]),_:1})])])):H("",!0)])])}}});export{et as default};
