import{d as S,R as x,r as _,c as A,e as y,f as M,y as r,x as p,g as m,B as d,u as l,A as g,Q as C,v as k}from"./base-d79f9f62.js";/* empty css                   *//* empty css                   *//* empty css                */import{_ as Q}from"./index.vue_vue_type_style_index_0_lang-9fd1bcaf.js";import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  */import{t}from"./index-9e0d1e6c.js";import{h as W,i as G,j as H,k as J}from"./weapp-96ac131c.js";import{u as K,b as O}from"./vue-router-fc35ac55.js";import{_ as X}from"./cron-info.vue_vue_type_script_setup_true_lang-5888c563.js";import{E as Y}from"./index-d1262e7a.js";import{E as Z}from"./index-03649f16.js";import{a as ee,E as te}from"./index-2b5d43b9.js";import{E as oe}from"./index-014848fe.js";import{E as ae}from"./index-ba59a1dc.js";import{E as re}from"./index-f249e665.js";import{a as ie,E as le}from"./index-6befecc6.js";import{E as ne}from"./index-d0ada8fb.js";import{v as pe}from"./directive-13582d99.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                    */import"./storage-5316d819.js";import"./index-2048a34f.js";import"./index-3fd412a3.js";import"./index-542aa78e.js";import"./typescript-defaf979.js";import"./index-34cd7f55.js";import"./index-50edbf04.js";import"./error-78e43d3e.js";import"./index-6229e0fd.js";import"./pinia-55149fa9.js";import"./index-6fcaf7b3.js";import"./system-d23898e7.js";import"./index-5dbb8f83.js";import"./index-cf3a42e3.js";import"./scroll-aa5f3aa0.js";import"./vnode-772b0c47.js";import"./aria-adfa05c5.js";import"./focus-trap-50fa5770.js";import"./validator-8f1b170d.js";import"./index-71aec1df.js";import"./index-bdfee32a.js";import"./index-427f5a83.js";import"./index-2462875f.js";import"./index-54a839cc.js";import"./_Uint8Array-bbbfd6ac.js";import"./_initCloneObject-a2c44136.js";import"./index-d4057e2a.js";import"./event-9519ab40.js";import"./isEqual-3f50b221.js";import"./flatten-0bbd547a.js";import"./_isIterateeCall-559d3e90.js";import"./debounce-6fd93949.js";import"./index-af085fbd.js";import"./index-f3bad52c.js";import"./index-3a5faaeb.js";import"./strings-d73e3c52.js";import"./index-b6ca69fd.js";const me={class:"main-container"},de={class:"flex justify-between items-center"},ue={class:"text-[20px]"},ce={class:"mt-[10px]"},_e={class:"mt-[16px] flex justify-end"},fe={class:"dialog-footer"},ve=S({__name:"weapp",setup(ge){const D=K().meta.title,o=x({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",type:"",last_time:""}});_();const u=(n=1)=>{o.loading=!0,o.page=n,W({page:o.page,limit:o.limit,...o.searchParam}).then(e=>{o.loading=!1,o.data=e.data.data,o.total=e.data.total}).catch(()=>{o.loading=!1})};u(),O();const c=_(!1),a=x({...{id:0,desc:"",path:"",version:"",type:"weapp"}}),b=_(),B=()=>{a.id=0,a.desc="",a.path="",a.version="",c.value=!0},T=A(()=>({version:[{required:!0,message:t("versionPlaceholder"),trigger:"blur"}],path:[{required:!0,validator:P,trigger:"blur"}]})),P=(n,e,s)=>a.path==""?s(new Error(t("filePlaceholder"))):s(),f=_(!1),z=async n=>{f.value||!n||await n.validate(async e=>{if(e){f.value=!0;const s=a;(a.id>0?G:H)(s).then(w=>{f.value=!1,c.value=!1,u()}).catch(()=>{f.value=!1})}})},R=n=>{a.id=n.id,a.desc=n.desc,a.path=n.path,a.version=n.version,c.value=!0},U=n=>{Y.confirm(t("weappVersionDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{J(n).then(()=>{u()}).catch(()=>{})})},$=_(null);return(n,e)=>{const s=Z,v=ee,w=te,j=oe,F=ae,E=re,h=ie,N=Q,I=le,L=ne,V=pe;return y(),M("div",me,[r(F,{class:"box-card !border-none",shadow:"never"},{default:p(()=>[m("div",de,[m("span",ue,d(l(D)),1),r(s,{type:"primary",onClick:B},{default:p(()=>[g(d(l(t)("addVersion")),1)]),_:1})]),m("div",ce,[C((y(),k(w,{data:o.data,size:"large"},{empty:p(()=>[m("span",null,d(o.loading?"":l(t)("emptyData")),1)]),default:p(()=>[r(v,{prop:"version",label:l(t)("version"),"min-width":"150"},null,8,["label"]),r(v,{prop:"create_time",label:l(t)("createTime"),"min-width":"150"},null,8,["label"]),r(v,{label:l(t)("operation"),align:"right",fixed:"right",width:"130"},{default:p(({row:i})=>[r(s,{type:"primary",link:"",onClick:q=>R(i)},{default:p(()=>[g(d(l(t)("edit")),1)]),_:2},1032,["onClick"]),r(s,{type:"primary",link:"",onClick:q=>U(i.id)},{default:p(()=>[g(d(l(t)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[V,o.loading]]),m("div",_e,[r(j,{"current-page":o.page,"onUpdate:current-page":e[0]||(e[0]=i=>o.page=i),"page-size":o.limit,"onUpdate:page-size":e[1]||(e[1]=i=>o.limit=i),layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:e[2]||(e[2]=i=>u()),onCurrentChange:u},null,8,["current-page","page-size","total"])])])]),_:1}),r(X,{ref_key:"cronDialog",ref:$,onComplete:o},null,8,["onComplete"]),r(L,{modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=i=>c.value=i),title:l(t)("editVersion"),width:"550px","destroy-on-close":!0},{footer:p(()=>[m("span",fe,[r(s,{type:"primary",onClick:e[6]||(e[6]=i=>z(b.value))},{default:p(()=>[g(d(l(t)("confirm")),1)]),_:1})])]),default:p(()=>[C((y(),k(I,{model:a,"label-width":"110px",ref_key:"formRef",ref:b,rules:l(T),class:"page-form"},{default:p(()=>[r(h,{label:l(t)("version"),prop:"version"},{default:p(()=>[r(E,{modelValue:a.version,"onUpdate:modelValue":e[3]||(e[3]=i=>a.version=i),placeholder:l(t)("versionPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(h,{label:l(t)("file"),prop:"path"},{default:p(()=>[r(N,{modelValue:a.path,"onUpdate:modelValue":e[4]||(e[4]=i=>a.path=i),class:"input-width",api:"applet/upload"},null,8,["modelValue"])]),_:1},8,["label"]),r(h,{label:l(t)("desc")},{default:p(()=>[r(E,{type:"textarea",modelValue:a.desc,"onUpdate:modelValue":e[5]||(e[5]=i=>a.desc=i),class:"input-width",clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[V,n.loading]])]),_:1},8,["modelValue","title"])])}}});const Ft=se(ve,[["__scopeId","data-v-c333e3a9"]]);export{Ft as default};
