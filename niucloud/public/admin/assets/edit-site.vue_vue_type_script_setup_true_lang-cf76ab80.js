import"./base-962c0c23.js";/* empty css                   */import{E as B}from"./el-overlay-60700377.js";/* empty css                  *//* empty css                     *//* empty css                       *//* empty css                 */import"./index-6ef4c1c3.js";import"./el-tooltip-58212670.js";/* empty css               *//* empty css                  *//* empty css                  */import{t as l}from"./index-e4761856.js";import{j as R,k as T,m as Y,n as j}from"./site-8741a80c.js";import{E as G}from"./index-93f2c618.js";import{a as M,E as O}from"./index-61c777fa.js";import{a as H,E as A}from"./index-b933df38.js";import{E as $}from"./index-f0f6eba4.js";import{E as z}from"./index-bba9e58c.js";import{v as J}from"./directive-c0c3e9a3.js";import{d as K,r as f,M as Q,c as V,b as n,m as c,p as i,f as W,q as d,i as P,v as x,x as E,u as o,L as X,e as Z,F as ee,t as le,C as w}from"./runtime-core.esm-bundler-dc7a07d7.js";const ae={class:"dialog-footer"},De=K({__name:"edit-site",emits:["complete"],setup(re,{expose:y,emit:D}){let u=f(!1);const s=f(!0);let _=f([]);const v={site_id:"",site_name:"",real_name:"",username:"",password:"",confirm_password:"",expire_time:"",group_id:""},a=Q({...v}),b=f();(async()=>{_.value=await(await R({})).data,_.value.length>0&&(a.group_id=_.value[0].group_id)})();const k=async(m=null)=>{if(s.value=!0,Object.assign(a,v),m){const e=await(await T(m.site_id)).data;Object.keys(a).forEach(t=>{e[t]!=null&&(a[t]=e[t])})}s.value=!1},q=V(()=>({site_name:[{required:!0,message:l("siteNamePlaceholder"),trigger:"blur"}],group_id:[{required:!0,message:l("groupIdPlaceholder"),trigger:"blur"}],username:[{required:!0,message:l("usernamePlaceholder"),trigger:"blur"}],password:[{required:!0,message:l("passwordPlaceholder"),trigger:"blur"}],real_name:[{required:!0,message:l("userRealNamePlaceholder"),trigger:"blur"}],confirm_password:[{required:!0,message:l("confirmPasswordPlaceholder"),trigger:"blur"},{validator:(m,e,t)=>{e!=a.password?t(new Error(l("confirmPasswordError"))):t()},trigger:"blur"}],expire_time:[{required:!0,message:l("expireTimePlaceholder"),trigger:"blur"}]})),N=V(()=>(f(""),s.value?"":a.site_id?l("editSite"):l("addSite"))),S=async m=>{s.value||!m||await m.validate(async e=>{if(e){s.value=!0;let t=a;(t.site_id?Y:j)(t).then(g=>{s.value=!1,u.value=!1,D("complete")}).catch(g=>{s.value=!1})}})};return y({showDialog:u,setFormData:k,loading:s}),(m,e)=>{const t=G,p=M,g=H,U=A,C=$,F=O,h=z,I=B,L=J;return n(),c(I,{modelValue:o(u),"onUpdate:modelValue":e[8]||(e[8]=r=>P(u)?u.value=r:u=r),title:o(N),width:"500px","destroy-on-close":!0},{footer:i(()=>[W("span",ae,[d(h,{onClick:e[6]||(e[6]=r=>P(u)?u.value=!1:u=!1)},{default:i(()=>[x(E(o(l)("cancel")),1)]),_:1}),d(h,{type:"primary",loading:s.value,onClick:e[7]||(e[7]=r=>S(b.value))},{default:i(()=>[x(E(o(l)("confirm")),1)]),_:1},8,["loading"])])]),default:i(()=>[X((n(),c(F,{model:a,"label-width":"90px",ref_key:"formRef",ref:b,rules:o(q),class:"page-form"},{default:i(()=>[d(p,{label:o(l)("siteName"),prop:"site_name"},{default:i(()=>[d(t,{modelValue:a.site_name,"onUpdate:modelValue":e[0]||(e[0]=r=>a.site_name=r),clearable:"",placeholder:o(l)("siteNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(p,{label:o(l)("groupId"),prop:"group_id"},{default:i(()=>[d(U,{modelValue:a.group_id,"onUpdate:modelValue":e[1]||(e[1]=r=>a.group_id=r),clearable:"",placeholder:o(l)("groupIdPlaceholder"),class:"input-width"},{default:i(()=>[(n(!0),Z(ee,null,le(o(_),r=>(n(),c(g,{label:r.group_name,value:r.group_id},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),!a.site_id&&!s.value?(n(),c(p,{key:0,label:o(l)("username"),prop:"username"},{default:i(()=>[d(t,{modelValue:a.username,"onUpdate:modelValue":e[2]||(e[2]=r=>a.username=r),clearable:"",placeholder:o(l)("usernamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),!a.site_id&&!s.value?(n(),c(p,{key:1,label:o(l)("password"),prop:"password"},{default:i(()=>[d(t,{modelValue:a.password,"onUpdate:modelValue":e[3]||(e[3]=r=>a.password=r),clearable:"",placeholder:o(l)("passwordPlaceholder"),class:"input-width","show-password":!0,type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),!a.site_id&&!s.value?(n(),c(p,{key:2,label:o(l)("confirmPassword"),prop:"confirm_password"},{default:i(()=>[d(t,{modelValue:a.confirm_password,"onUpdate:modelValue":e[4]||(e[4]=r=>a.confirm_password=r),placeholder:o(l)("confirmPasswordPlaceholder"),type:"password","show-password":!0,clearable:"",class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),d(p,{label:o(l)("expireTime"),prop:"expire_time",class:"input-width"},{default:i(()=>[d(C,{class:"flex-1 !flex",modelValue:a.expire_time,"onUpdate:modelValue":e[5]||(e[5]=r=>a.expire_time=r),clearable:"",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:o(l)("expireTimePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[L,s.value]])]),_:1},8,["modelValue","title"])}}});export{De as _};
