import{d as ne,r as T,o as de,E as $,R as re,c as me,V as ue,e as x,f as y,Q as ce,g as s,u as o,B as d,y as a,x as n,A as m,F as g,z as q,n as _e,v as pe,H as fe,bl as be,bm as xe}from"./base-04829be5.js";/* empty css                   *//* empty css                  *//* empty css               *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                *//* empty css                *//* empty css                     *//* empty css                 */import{u as ye,t as l}from"./index-043d021e.js";import{b as ve,e as he}from"./tools-99382199.js";import{u as ge,b as we}from"./vue-router-fee568b2.js";import{S as L}from"./sortable.esm-be94e56d.js";import{F as Ve}from"./index-30df2c14.js";import{d as ke}from"./index-faea7bd5.js";import{c as O}from"./cloneDeep-44ad47b7.js";import{E as G}from"./index-b649d1d3.js";import{r as W}from"./range-2819bbed.js";import{E as qe}from"./index-db9b8d96.js";import{a as Ie,E as Ee}from"./index-6bd50bb5.js";import{E as Fe,b as ze}from"./index-1cbf3455.js";import{E as Te}from"./index-88566e4e.js";import{E as Ne}from"./index-0a7dfd1f.js";import{E as Ce,a as Se}from"./index-cbf0aee7.js";import{E as Ue}from"./index-7e933ae4.js";import{a as je,E as Re}from"./index-02bf3820.js";import{E as De}from"./index-eb678249.js";import{v as Pe}from"./directive-013f0a4e.js";import{_ as Be}from"./_plugin-vue_export-helper-c27b6911.js";import"./common-111e3797.js";import"./common-2cf17469.js";import"./storage-1a3ddb14.js";import"./index-236cb599.js";import"./index-92283b18.js";import"./typescript-defaf979.js";import"./index-a2524300.js";import"./_isIterateeCall-f0970b1f.js";import"./_Uint8Array-99b916e9.js";import"./debounce-f064e94e.js";import"./event-9519ab40.js";import"./index-d7f4b4bb.js";import"./index-de053f2e.js";import"./error-78e43d3e.js";import"./castArray-11aea762.js";import"./_initCloneObject-e5a1aa13.js";import"./index-94a82d50.js";import"./focus-trap-be36cfe9.js";import"./index-e9e16697.js";import"./index-bf9de702.js";import"./strings-4ec3ae35.js";import"./index-1d455165.js";import"./index-4edf2cad.js";import"./scroll-e5463626.js";import"./isEqual-ba353d68.js";import"./index-b519934c.js";import"./validator-6838b9a3.js";const K=I=>(be("data-v-0535e101"),I=I(),xe(),I),Ae={class:"main-container mb-80"},$e={class:"detail-head !mb-[10px]"},Le=K(()=>s("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1)),Oe={class:"ml-[1px]"},Ge=K(()=>s("span",{class:"adorn"},"|",-1)),We={class:"right"},Ke=["data-id"],Qe=["data-id"],Ze=["data-id","onClick"],He={class:"flex flex-row"},Je={class:"flex flex-row design-field"},Me={class:"text-xs text-gray-500 w-28 items-center justify-end flex"},Xe={class:"flex flex-row design-field"},Ye={class:"text-xs text-gray-500 w-28 items-center justify-end flex"},el={class:"flex flex-row design-field flex-shrink-0 w-40"},ll={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},tl={class:"w-50 m-2"},ol=["onClick"],al={class:"flex flex-row"},sl={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},il={class:"flex flex-row"},nl={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},dl={class:"flex flex-row"},rl={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},ml={class:"flex flex-row"},ul={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},cl={class:"flex flex-row"},_l={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},pl={class:"flex flex-row"},fl={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},bl={class:"flex flex-row"},xl={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},yl={class:"flex flex-row"},vl={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},hl={class:"flex flex-row"},gl={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},wl={class:"flex flex-row"},Vl={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},kl={class:"flex flex-row"},ql={class:"text-xs text-gray-500 w-20 items-center justify-end flex"},Il={class:"fixed-footer-wrap"},El={class:"fixed-footer"},Fl=ne({__name:"edit",setup(I){const Q=ke();ye();const F=ge(),N=we(),Z=F.meta.title,C=parseInt(F.query.id||0),v=T(!0),z=Ve(),S=T();let U=1;const j={id:"",table_name:"",table_content:"",module_name:"",class_name:"",edit_type:1,table_column:[],editFiledIndex:0},E={common:[{column_name:"id",column_comment:l("pk"),column_type:"int",is_required:1,is_pk:1,is_insert:0,is_update:0,is_lists:0,is_query:1,is_search:0,query_type:"=",view_type:"input"},{column_name:"status",column_comment:l("status"),column_type:"int",is_required:1,is_pk:0,is_insert:1,is_update:1,is_lists:1,is_query:1,is_search:0,query_type:"=",view_type:"radio"},{column_name:"create_time",column_comment:l("createTime"),column_type:"int",is_required:0,is_pk:0,is_insert:0,is_update:0,is_lists:1,is_query:1,is_search:0,query_type:"BETWEEN",view_type:"datetime"},{column_name:"update_time",column_comment:l("updateTime"),column_type:"int",is_required:0,is_pk:0,is_insert:0,is_update:0,is_lists:1,is_query:1,is_search:0,query_type:"BETWEEN",view_type:"datetime"}],base:[{column_name:"string",column_comment:l("string"),column_type:"string",is_required:1,is_pk:0,is_insert:1,is_update:1,is_lists:1,is_query:1,is_search:1,query_type:"=",view_type:"input"},{column_name:"image",column_comment:l("image"),column_type:"string",is_required:1,is_pk:0,is_insert:1,is_update:1,is_lists:1,is_query:1,is_search:1,query_type:"=",view_type:"imageSelect"},{column_name:"radio",column_comment:l("radio"),column_type:"int",is_required:1,is_pk:0,is_insert:1,is_update:1,is_lists:1,is_query:1,is_search:1,query_type:"=",view_type:"radio"},{column_name:"checkbox",column_comment:l("checkbox"),column_type:"string",is_required:1,is_pk:0,is_insert:1,is_update:1,is_lists:1,is_query:1,is_search:1,query_type:"=",view_type:"checkbox"},{column_name:"select",column_comment:l("select"),column_type:"string",is_required:1,is_pk:0,is_insert:1,is_update:1,is_lists:1,is_query:1,is_search:1,query_type:"=",view_type:"select"},{column_name:"editor",column_comment:l("editor"),column_type:"string",is_required:1,is_pk:0,is_insert:1,is_update:1,is_lists:1,is_query:1,is_search:1,query_type:"=",view_type:"editor"},{column_name:"datetime",column_comment:l("dateTime"),column_type:"string",is_required:1,is_pk:0,is_insert:1,is_update:1,is_lists:1,is_query:1,is_search:1,query_type:"=",view_type:"datetime"}]},H=["=","!=",">",">=","<","<=","LIKE","BETWEEN"],J=[{label:l("formInput"),value:"input"},{label:l("formTextarea"),value:"textarea"},{label:l("formSelect"),value:"select"},{label:l("formRadio"),value:"radio"},{label:l("formCheckbox"),value:"checkbox"},{label:l("formDateTime"),value:"datetime"},{label:l("formImageSelect"),value:"imageSelect"},{label:l("formEditor"),value:"editor"}],M=c=>{e.editFiledIndex=c};de(()=>{const c=L.create(S.value,{group:"design-field",animation:200,onAdd:t=>{var _,f;const r=(f=(_=t.originalEvent)==null?void 0:_.dataTransfer)==null?void 0:f.getData("name"),u=E[r];if(u&&u[t.oldIndex]){const b=O(u[t.oldIndex]);if(b.is_pk){if(e.table_column.find(V=>V.is_pk))return G({type:"error",message:l("pkRepeatTip")}),t.item.remove();e.table_column.defaultSortField=b.name,e.table_column.quickSearchField.push(b.name)}X(e.table_column,"column_name",b.column_name)&&(b.column_name=b.column_name+U,U++),e.table_column.splice(t.newIndex,0,b)}t.item.remove(),$(()=>{c.sort(W(e.table_column.length).map(b=>b.toString()))})},onEnd:t=>{const r=e.table_column[t.oldIndex];e.table_column.splice(t.oldIndex,1),e.table_column.splice(t.newIndex,0,r),$(()=>{c.sort(W(e.table_column.length).map(u=>u.toString()))})}});z.value.forEach((t,r)=>{L.create(t,{sort:!1,group:{name:"design-field",pull:"clone",put:!1},animation:200,setData:u=>{u.setData("name",Object.keys(E)[r])}})})});const X=(c,t,r)=>{for(const u in c)if(c[u][t]==r)return u;return!1},e=re({...j});C&&(async(c=0)=>{Object.assign(e,j);const t=await(await ve(c)).data;Object.keys(e).forEach(r=>{t[r]!=null&&(e[r]=t[r])}),v.value=!1})(C);const R=T(),D=c=>/^([a-zA-Z_$])([a-zA-Z0-9_$])*$/.test(c),Y=me(()=>({table_name:[{required:!0,message:l("tableNamePlaceholder"),trigger:"blur"},{validator:(c,t,r)=>{D(t)||r(new Error(l("tableNameValidata"))),r()},trigger:"blur"}],table_content:[{required:!0,message:l("tableContentPlaceholder"),trigger:"blur"}]})),ee=async c=>{if(v.value||!c)return;let t="";if(e.table_column.find(u=>{if(!D(u.column_name))return t=u.column_name+" "+l("fieldNameValidata"),!0}),t){G({type:"error",message:t});return}v.value=!0;const r=O(e);r.table_column=JSON.stringify(r.table_column),he(r).then(u=>{v.value=!1}).catch(()=>{v.value=!1})},le=c=>{e.table_column[c]&&(e.editFiledIndex==c&&(e.editFiledIndex=0),e.table_column.splice(c,1))},te=()=>{Q.removeTab(F.path),N.push({path:"/tools/code"})};return(c,t)=>{const r=qe,u=Ie,_=Fe,f=ze,b=Ee,w=Te,h=Ne,V=Ce,oe=ue("Delete"),ae=Ue,P=je,B=Re,se=Se,A=De,ie=Pe;return x(),y(g,null,[ce((x(),y("div",Ae,[s("div",$e,[s("div",{class:"left",onClick:t[0]||(t[0]=i=>o(N).push({path:"/admin/tools/code"}))},[Le,s("span",Oe,d(o(l)("returnToPreviousPage")),1)]),Ge,s("span",We,d(o(Z)),1)]),a(w,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[a(b,{model:e,"label-width":"90px",ref_key:"formRef",ref:R,rules:o(Y),class:"page-form"},{default:n(()=>[a(u,{label:o(l)("tableName"),prop:"table_name"},{default:n(()=>[a(r,{modelValue:e.table_name,"onUpdate:modelValue":t[1]||(t[1]=i=>e.table_name=i),clearable:"",placeholder:o(l)("tableNamePlaceholder"),class:"input-width",maxlength:"64"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:o(l)("tableContent"),prop:"table_content"},{default:n(()=>[a(r,{modelValue:e.table_content,"onUpdate:modelValue":t[2]||(t[2]=i=>e.table_content=i),clearable:"",placeholder:o(l)("tableContentPlaceholder"),class:"input-width",maxlength:"64"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:o(l)("moduleName")},{default:n(()=>[a(r,{modelValue:e.module_name,"onUpdate:modelValue":t[3]||(t[3]=i=>e.module_name=i),clearable:"",placeholder:o(l)("moduleNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:o(l)("className")},{default:n(()=>[a(r,{modelValue:e.class_name,"onUpdate:modelValue":t[4]||(t[4]=i=>e.class_name=i),clearable:"",placeholder:o(l)("classNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:o(l)("editType")},{default:n(()=>[a(f,{modelValue:e.edit_type,"onUpdate:modelValue":t[5]||(t[5]=i=>e.edit_type=i),placeholder:o(l)("editTypePlaceholder")},{default:n(()=>[a(_,{label:1},{default:n(()=>[m(d(o(l)("popup")),1)]),_:1}),a(_,{label:2},{default:n(()=>[m(d(o(l)("page")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1}),a(se,{class:"flex mt-4",gutter:15},{default:n(()=>[a(V,{span:6},{default:n(()=>[a(w,{class:"box-card !border-none p-none",shadow:"never"},{default:n(()=>[a(h,{"content-position":"left"},{default:n(()=>[m(d(o(l)("commentField")),1)]),_:1}),s("div",{class:"flex flex-row m-0.5 cursor-pointer flex-wrap",ref:o(z).set},[(x(!0),y(g,null,q(E.common,(i,p)=>(x(),y("div",{class:"border border-dashed border-gray-200 mt-2 text-sm mr-2 pt-1 pb-1 pl-1.5 pr-1.5 dashed-border design-field",key:p,"data-id":p},d(i.column_comment),9,Ke))),128))],512),a(h,{"content-position":"left"},{default:n(()=>[m(d(o(l)("baseField")),1)]),_:1}),s("div",{class:"flex flex-row m-0.5 cursor-pointer flex-wrap",ref:o(z).set},[(x(!0),y(g,null,q(E.base,(i,p)=>(x(),y("div",{class:"border border-dashed border-gray-200 mt-2 text-sm mr-2 pt-1 pb-1 pl-1.5 pr-1.5 dashed-border design-field",key:p,"data-id":p},d(i.column_comment),9,Qe))),128))],512)]),_:1})]),_:1}),a(V,{span:12},{default:n(()=>[a(w,{class:"box-card !border-none p-none",shadow:"never"},{default:n(()=>[s("div",{class:"flex flex-col",ref_key:"fieldBoxRef",ref:S},[(x(!0),y(g,null,q(e.table_column,(i,p)=>(x(),y("div",{class:_e(["flex flex-row m-0.5 cursor-pointer justify-between items-center border border-dashed border-gray-200 dashed-border p-2 pt-1 pb-1",p===e.editFiledIndex?"activate":""]),key:p,"data-id":p,onClick:k=>M(p)},[s("div",He,[s("div",Je,[s("div",Me,d(o(l)("columnName"))+"：",1),a(r,{class:"w-50 m-2",modelValue:i.column_name,"onUpdate:modelValue":k=>i.column_name=k,size:"small",placeholder:o(l)("columnNamePlaceholder")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),s("div",Xe,[s("div",Ye,d(o(l)("columnComment"))+"：",1),a(r,{class:"w-50 m-2",modelValue:i.column_comment,"onUpdate:modelValue":k=>i.column_comment=k,size:"small",placeholder:o(l)("columnCommentPlaceholder")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),s("div",el,[s("div",ll,d(o(l)("columnType"))+"：",1),s("div",tl,d(i.column_type),1)])]),s("div",{onClick:k=>le(p),class:"items-center justify-center flex items-center flex-shrink-0 rounded-full bg-red-400 text-white icon-btn w-7 h-7"},[a(ae,null,{default:n(()=>[a(oe)]),_:1})],8,ol)],10,Ze))),128))],512)]),_:1})]),_:1}),a(V,{span:6},{default:n(()=>[e.table_column.length?(x(),pe(w,{key:0,class:"box-card !border-none p-none",shadow:"never"},{default:n(()=>[a(h,{"content-position":"left"},{default:n(()=>[m(d(o(l)("fieldAttribute")),1)]),_:1}),s("div",null,[s("div",al,[s("div",sl,d(o(l)("columnName"))+"： ",1),s("div",null,[a(r,{class:"w-50 m-2",modelValue:e.table_column[e.editFiledIndex].column_name,"onUpdate:modelValue":t[6]||(t[6]=i=>e.table_column[e.editFiledIndex].column_name=i),size:"small",placeholder:o(l)("columnNamePlaceholder")},null,8,["modelValue","placeholder"])])]),s("div",il,[s("div",nl,d(o(l)("columnComment"))+"： ",1),s("div",null,[a(r,{class:"w-50 m-2",modelValue:e.table_column[e.editFiledIndex].column_comment,"onUpdate:modelValue":t[7]||(t[7]=i=>e.table_column[e.editFiledIndex].column_comment=i),size:"small",placeholder:o(l)("columnCommentPlaceholder")},null,8,["modelValue","placeholder"])])]),s("div",dl,[s("div",rl,d(o(l)("isPk"))+"：",1),s("div",null,[a(f,{class:"ml-4",modelValue:e.table_column[e.editFiledIndex].is_pk,"onUpdate:modelValue":t[8]||(t[8]=i=>e.table_column[e.editFiledIndex].is_pk=i)},{default:n(()=>[a(_,{label:1,size:"large"},{default:n(()=>[m(d(o(l)("yes")),1)]),_:1}),a(_,{label:0,size:"large"},{default:n(()=>[m(d(o(l)("no")),1)]),_:1})]),_:1},8,["modelValue"])])]),s("div",ml,[s("div",ul,d(o(l)("viewType"))+"： ",1),s("div",null,[a(B,{class:"m-2",placeholder:o(l)("selectPlaceholder"),size:"small",modelValue:e.table_column[e.editFiledIndex].view_type,"onUpdate:modelValue":t[9]||(t[9]=i=>e.table_column[e.editFiledIndex].view_type=i)},{default:n(()=>[(x(),y(g,null,q(J,(i,p)=>a(P,{label:i.label,value:i.value,key:p},null,8,["label","value"])),64))]),_:1},8,["placeholder","modelValue"])])])]),a(h,{"content-position":"left"},{default:n(()=>[m(d(o(l)("addAndEdit")),1)]),_:1}),s("div",null,[s("div",cl,[s("div",_l,d(o(l)("isInsert"))+"： ",1),s("div",null,[a(f,{class:"ml-4",modelValue:e.table_column[e.editFiledIndex].is_insert,"onUpdate:modelValue":t[10]||(t[10]=i=>e.table_column[e.editFiledIndex].is_insert=i)},{default:n(()=>[a(_,{label:1,size:"large"},{default:n(()=>[m(d(o(l)("yes")),1)]),_:1}),a(_,{label:0,size:"large"},{default:n(()=>[m(d(o(l)("no")),1)]),_:1})]),_:1},8,["modelValue"])])]),s("div",pl,[s("div",fl,d(o(l)("isUpdate"))+"： ",1),s("div",null,[a(f,{class:"ml-4",modelValue:e.table_column[e.editFiledIndex].is_update,"onUpdate:modelValue":t[11]||(t[11]=i=>e.table_column[e.editFiledIndex].is_update=i)},{default:n(()=>[a(_,{label:1,size:"large"},{default:n(()=>[m(d(o(l)("yes")),1)]),_:1}),a(_,{label:0,size:"large"},{default:n(()=>[m(d(o(l)("no")),1)]),_:1})]),_:1},8,["modelValue"])])]),s("div",bl,[s("div",xl,d(o(l)("isRequired"))+"： ",1),s("div",null,[a(f,{class:"ml-4",modelValue:e.table_column[e.editFiledIndex].is_required,"onUpdate:modelValue":t[12]||(t[12]=i=>e.table_column[e.editFiledIndex].is_required=i)},{default:n(()=>[a(_,{label:1,size:"large"},{default:n(()=>[m(d(o(l)("yes")),1)]),_:1}),a(_,{label:0,size:"large"},{default:n(()=>[m(d(o(l)("no")),1)]),_:1})]),_:1},8,["modelValue"])])])]),a(h,{"content-position":"left"},{default:n(()=>[m(d(o(l)("listSearch")),1)]),_:1}),s("div",null,[s("div",yl,[s("div",vl,d(o(l)("isLists"))+"：",1),s("div",null,[a(f,{class:"ml-4",modelValue:e.table_column[e.editFiledIndex].is_lists,"onUpdate:modelValue":t[13]||(t[13]=i=>e.table_column[e.editFiledIndex].is_lists=i)},{default:n(()=>[a(_,{label:1,size:"large"},{default:n(()=>[m(d(o(l)("yes")),1)]),_:1}),a(_,{label:0,size:"large"},{default:n(()=>[m(d(o(l)("no")),1)]),_:1})]),_:1},8,["modelValue"])])]),s("div",hl,[s("div",gl,d(o(l)("isSearch"))+"： ",1),s("div",null,[a(f,{class:"ml-4",modelValue:e.table_column[e.editFiledIndex].is_search,"onUpdate:modelValue":t[14]||(t[14]=i=>e.table_column[e.editFiledIndex].is_search=i)},{default:n(()=>[a(_,{label:1,size:"large"},{default:n(()=>[m(d(o(l)("yes")),1)]),_:1}),a(_,{label:0,size:"large"},{default:n(()=>[m(d(o(l)("no")),1)]),_:1})]),_:1},8,["modelValue"])])]),s("div",wl,[s("div",Vl,d(o(l)("isQuery"))+"：",1),s("div",null,[a(f,{class:"ml-4",modelValue:e.table_column[e.editFiledIndex].is_query,"onUpdate:modelValue":t[15]||(t[15]=i=>e.table_column[e.editFiledIndex].is_query=i)},{default:n(()=>[a(_,{label:1,size:"large"},{default:n(()=>[m(d(o(l)("yes")),1)]),_:1}),a(_,{label:0,size:"large"},{default:n(()=>[m(d(o(l)("no")),1)]),_:1})]),_:1},8,["modelValue"])])]),s("div",kl,[s("div",ql,d(o(l)("queryType"))+"： ",1),s("div",null,[a(B,{class:"m-2",placeholder:o(l)("selectPlaceholder"),size:"small",modelValue:e.table_column[e.editFiledIndex].query_type,"onUpdate:modelValue":t[16]||(t[16]=i=>e.table_column[e.editFiledIndex].query_type=i)},{default:n(()=>[(x(),y(g,null,q(H,(i,p)=>a(P,{label:i,value:i,key:p},null,8,["label","value"])),64))]),_:1},8,["placeholder","modelValue"])])])])]),_:1})):fe("",!0)]),_:1})]),_:1})])),[[ie,v.value]]),s("div",Il,[s("div",El,[a(A,{type:"primary",onClick:t[17]||(t[17]=i=>ee(R.value))},{default:n(()=>[m(d(o(l)("save")),1)]),_:1}),a(A,{onClick:t[18]||(t[18]=i=>te())},{default:n(()=>[m(d(o(l)("cancel")),1)]),_:1})])])],64)}}});const Dt=Be(Fl,[["__scopeId","data-v-0535e101"]]);export{Dt as default};
