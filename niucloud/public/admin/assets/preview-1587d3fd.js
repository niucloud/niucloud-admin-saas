import{d as R,r as s,R as A,w as H,e as b,f as B,Q as u,g as o,B as n,u as r,y as l,x as p,A as S,v as N,H as M}from"./base-d79f9f62.js";/* empty css                *//* empty css                 *//* empty css                        */import"./el-form-item-4ed993c7.js";/* empty css                  *//* empty css                 */import{E as Q,v}from"./index-3fd412a3.js";import{t as a}from"./index-9e0d1e6c.js";import{u as W}from"./vue-router-fc35ac55.js";import{g as j}from"./weapp-96ac131c.js";import{v as z}from"./sys-3d5b784a.js";import{f as G,a as J}from"./storage-5316d819.js";import{b as K}from"./browser-a1ac24ac.js";import{l as O}from"./diy-8086ee6b.js";import{a as h}from"./index-542aa78e.js";import{E as X}from"./index-f249e665.js";import{E as Y}from"./index-03649f16.js";import{a as Z,E as ee}from"./index-6befecc6.js";import{E as ae}from"./index-8774d4a8.js";import"./index-2048a34f.js";import"./pinia-55149fa9.js";import"./index-6fcaf7b3.js";import"./system-d23898e7.js";import"./index-5dbb8f83.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./typescript-defaf979.js";import"./index-34cd7f55.js";import"./event-9519ab40.js";import"./index-b6ca69fd.js";import"./index-427f5a83.js";import"./index-71aec1df.js";import"./error-78e43d3e.js";import"./index-bdfee32a.js";import"./_Uint8Array-bbbfd6ac.js";import"./_initCloneObject-a2c44136.js";import"./index-51305aa3.js";import"./index-6229e0fd.js";import"./debounce-6fd93949.js";import"./position-4bcbb4c8.js";import"./scroll-aa5f3aa0.js";const te={class:"main-container w-[375px] mx-auto my-[20px] relative"},oe={class:"flex h-full"},re=["src"],le={class:"w-[375px] border border-slate-100 bg-body pt-[20px] px-[20px]"},se={class:"font-bold text-xl mb-[40px]"},pe={class:"mb-[20px] flex flex-col"},ie={class:"mb-[10px]"},ne={key:0,class:"w-[400px] absolute bg-body top-[10%] -right-[450px]"},me={class:"info-wrap mt-[20px]"},ce={class:"px-[20px] pb-[10px] font-bold"},de={class:"px-[20px] pb-[10px] font-bold mt-[40px]"},ue={class:"text-gray-400"},ta=R({__name:"preview",setup(ve){const _=s(""),c=s(""),f=s(""),i=s(""),E=s(!1),d=s(!1),x=s(!1),T=s(0);new Date().getTime();const m=W();m.query.id=m.query.id||0,m.query.name=m.query.name||"",z().then(e=>{c.value=e.data.wap_domain,_.value=e.data.wap_url,D()});const L=()=>{if(c.value.trim().length==0){h({type:"warning",message:`${a("wapDomainPlaceholder")}`});return}_.value=c.value+"/wap",D(),J.set({key:"wap_domain",data:_.value}),d.value=!0,x.value=!1},D=()=>{O({id:m.query.id,name:m.query.name}).then(e=>{let t=e.data;i.value=`${_.value}/${t.page}`,K.toDataURL(i.value,{errorCorrectionLevel:"L",margin:0,width:100}).then(w=>{f.value=w})})},P=()=>{if(i.value){var e=new Date().getTime(),t=e-T.value;t<1e3?(x.value=!0,d.value=!1,i.value="",f.value=""):(x.value=!1,d.value=!0),E.value=!0}},y=A({qr_code:""});s("weapp"),j().then(e=>{if(e.code==1){let t=e.data;y.qr_code=t.qr_code}});const{copy:U,isSupported:$,copied:q}=Q(),F=e=>{$.value||h({message:a("notSupportCopy"),type:"warning"}),U(e)};return H(q,()=>{q.value&&h({message:a("copySuccess"),type:"success"})}),(e,t)=>{const w=X,k=Y,g=Z,C=ae,I=ee;return b(),B("div",te,[u(o("div",oe,[u(o("iframe",{class:"w-[375px] border border-slate-100 bg-gray-100",src:i.value,frameborder:"0",id:"previewIframe",onLoad:P},null,40,re),[[v,d.value]]),u(o("div",le,[o("div",se,n(r(a)("developTitle")),1),o("div",pe,[o("text",ie,n(r(a)("wapDomain")),1),l(w,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=V=>c.value=V),placeholder:r(a)("wapDomainPlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),l(k,{type:"primary",onClick:L},{default:p(()=>[S(n(r(a)("confirm")),1)]),_:1})],512),[[v,x.value]]),d.value?(b(),B("div",ne,[o("div",me,[o("div",ce,n(r(a)("h5")),1),l(I,{"label-width":"40px",class:"px-[20px]"},{default:p(()=>[u(l(g,{label:r(a)("link")},{default:p(()=>[l(w,{readonly:"",value:i.value},{append:p(()=>[l(k,{onClick:t[1]||(t[1]=V=>F(i.value)),class:"bg-primary copy"},{default:p(()=>[S(n(r(a)("copy")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),[[v,i.value]]),u(l(g,{label:" "},{default:p(()=>[l(C,{src:f.value},null,8,["src"])]),_:1},512),[[v,f.value]])]),_:1}),o("div",de,n(r(a)("weapp")),1),l(I,{"label-width":"40px",class:"px-[20px]"},{default:p(()=>[y.qr_code?(b(),N(g,{key:0,label:" "},{default:p(()=>[l(C,{class:"w-[100px] h-[100px]",src:r(G)(y.qr_code)},null,8,["src"])]),_:1})):(b(),N(g,{key:1,label:" "},{default:p(()=>[o("span",ue,n(r(a)("weappNotSet")),1)]),_:1}))]),_:1})])])):M("",!0)],512),[[v,E.value]])])}}});export{ta as default};
