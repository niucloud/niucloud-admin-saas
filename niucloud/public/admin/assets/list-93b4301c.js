import{d as W,O as X,r as k,n as K,f as Q,h as i,c as f,e as l,w as r,a as c,t as p,u as s,i as u,N as a,F as C,G as D,I as h,y as Z,R as ee,B as ae,a4 as te,a8 as le,E as se,W as oe,X as re,aC as ne,aD as ie,cJ as pe,Y as de,$ as ue,ah as ce,av as me,aj as _e,as as fe,a0 as he,_ as ge}from"./index-9d601459.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                *//* empty css                *//* empty css                       *//* empty css                  */import"./el-form-item-4ed993c7.js";import{_ as ve}from"./site_logo-f276251b.js";import{i as be,s as ye,t as xe,v as ke,w as we,x as Pe}from"./site-c0bc0315.js";import{_ as Ce}from"./edit-site.vue_vue_type_script_setup_true_lang-e1653314.js";import{g as De}from"./addon-cbb2516a.js";/* empty css                   *//* empty css                   *//* empty css                  *//* empty css                */import"./member_head-a897263d.js";import"./user-55c339c6.js";const Ve={class:"main-container"},Ee={class:"flex justify-between items-center"},Se={class:"text-[20px]"},Ie={class:"mt-[20px]"},Le={class:"flex items-center"},Te=["src"],$e={key:1,class:"w-[50px] h-[50px] mr-[10px]",src:ve,alt:""},Fe={class:"flex flex flex-col"},Be={class:"flex items-center"},Ue={class:"flex flex flex-col"},Ye={key:0},Ne={key:1},Me={class:"mt-[16px] flex justify-end"},je=W({__name:"list",setup(ze){const V=X(),$=V.meta.title,b=k({all:[]}),E=k([]),o=K({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{keywords:"",group_id:"",app:"all",status:"",create_time:[],expire_time:[]}});o.searchParam.status=V.query.id||"",(async()=>{let n=await(await be({})).data;b.value.all=n,n.forEach((t,d)=>{b.value[t.app]||(b.value[t.app]=[]),b.value[t.app].push(t)})})(),(async()=>{E.value=await(await ye()).data})();const S=k(),F=n=>{n&&(n.resetFields(),m())},B=n=>{o.searchParam.group_id=""},I=k([]);De().then(({data:n})=>{I.value=n}).catch();const m=(n=1)=>{o.loading=!0,o.page=n,o.searchParam.app=o.searchParam.app=="all"?"":o.searchParam.app,xe({page:o.page,limit:o.limit,...o.searchParam}).then(t=>{o.loading=!1,o.data=t.data.data,o.total=t.data.total}).catch(()=>{o.loading=!1})};m();const U=Q(),x=k(null),Y=n=>{x.value.setFormData(),x.value.showDialog=!0},N=n=>{U.push({path:"/admin/site/info",query:{id:n.site_id}})},M=n=>{te({message:a("siteUrlDevelopMessage"),grouping:!0,type:"success"})},j=n=>{x.value.setFormData(n),x.value.showDialog=!0},z=n=>{window.localStorage.setItem("site.siteId",n.site_id),window.open(`${location.origin}/site/`)},R=(n,t)=>{n==1&&ke({site_id:t}).then(d=>{m()}),n==3&&we({site_id:t}).then(d=>{m()})},G=n=>{le.confirm(a("siteDeleteTips"),a("warning"),{confirmButtonText:a("confirm"),cancelButtonText:a("cancel"),type:"warning"}).then(()=>{Pe(n.site_id).then(t=>{m()}).catch(()=>{})})};return(n,t)=>{const d=se,H=oe,g=re,y=ne,w=ie,L=pe,O=de,T=ue,_=ce,P=me,q=_e,A=fe,J=he;return i(),f("div",Ve,[l(T,{class:"box-card !border-none",shadow:"never"},{default:r(()=>[c("div",Ee,[c("span",Se,p(s($)),1),l(d,{type:"primary",class:"w-[100px]",onClick:Y},{default:r(()=>[u(p(s(a)("addSite")),1)]),_:1})]),l(T,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:r(()=>[l(O,{inline:!0,model:o.searchParam,ref_key:"searchFormRef",ref:S},{default:r(()=>[l(g,{label:s(a)("siteName"),prop:"keywords"},{default:r(()=>[l(H,{modelValue:o.searchParam.keywords,"onUpdate:modelValue":t[0]||(t[0]=e=>o.searchParam.keywords=e),placeholder:s(a)("siteNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:s(a)("app"),prop:"app_id"},{default:r(()=>[l(w,{modelValue:o.searchParam.app,"onUpdate:modelValue":t[1]||(t[1]=e=>o.searchParam.app=e),clearable:"",onChange:B,placeholder:s(a)("appIdPlaceholder"),class:"input-width"},{default:r(()=>[l(y,{label:s(a)("selectPlaceholder"),value:"all"},null,8,["label"]),(i(!0),f(C,null,D(Object.values(I.value),e=>(i(),h(y,{label:e.title,value:e.key},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:s(a)("groupId"),prop:"group_id"},{default:r(()=>[l(w,{modelValue:o.searchParam.group_id,"onUpdate:modelValue":t[2]||(t[2]=e=>o.searchParam.group_id=e),clearable:"",placeholder:s(a)("groupIdPlaceholder"),class:"input-width"},{default:r(()=>[l(y,{label:s(a)("selectPlaceholder"),value:""},null,8,["label"]),(i(!0),f(C,null,D(b.value[o.searchParam.app],e=>(i(),h(y,{label:e.group_name,value:e.group_id},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:s(a)("status"),prop:"status"},{default:r(()=>[l(w,{modelValue:o.searchParam.status,"onUpdate:modelValue":t[3]||(t[3]=e=>o.searchParam.status=e),clearable:"",placeholder:s(a)("groupIdPlaceholder"),class:"input-width"},{default:r(()=>[l(y,{label:s(a)("selectPlaceholder"),value:""},null,8,["label"]),(i(!0),f(C,null,D(E.value,(e,v)=>(i(),h(y,{label:e,value:v},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:s(a)("createTime"),prop:"create_time"},{default:r(()=>[l(L,{modelValue:o.searchParam.create_time,"onUpdate:modelValue":t[4]||(t[4]=e=>o.searchParam.create_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":s(a)("startDate"),"end-placeholder":s(a)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(g,{label:s(a)("expireTime"),prop:"expire_time"},{default:r(()=>[l(L,{modelValue:o.searchParam.expire_time,"onUpdate:modelValue":t[5]||(t[5]=e=>o.searchParam.expire_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":s(a)("startDate"),"end-placeholder":s(a)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(g,null,{default:r(()=>[l(d,{type:"primary",onClick:t[6]||(t[6]=e=>m())},{default:r(()=>[u(p(s(a)("search")),1)]),_:1}),l(d,{onClick:t[7]||(t[7]=e=>F(S.value))},{default:r(()=>[u(p(s(a)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),c("div",Ie,[Z((i(),h(q,{data:o.data,size:"large"},{empty:r(()=>[c("span",null,p(o.loading?"":s(a)("emptyData")),1)]),default:r(()=>[l(_,{prop:"site_id",label:s(a)("siteId"),width:"100","show-overflow-tooltip":!0},null,8,["label"]),l(_,{label:s(a)("siteInfo"),width:"300",align:"left"},{default:r(({row:e})=>[c("div",Le,[e.logo?(i(),f("img",{key:0,class:"w-[50px] h-[50px] mr-[10px]",src:s(ee)(e.logo),alt:""},null,8,Te)):(i(),f("img",$e)),c("div",Fe,[c("span",null,p(e.site_name||""),1)])])]),_:1},8,["label"]),l(_,{label:s(a)("manager"),width:"150",align:"left"},{default:r(({row:e})=>[c("div",Be,[c("div",Ue,[c("span",null,p(e.admin.username||""),1)])])]),_:1},8,["label"]),l(_,{prop:"app_name",label:s(a)("app"),width:"150","show-overflow-tooltip":!0},null,8,["label"]),l(_,{prop:"group_name",label:s(a)("groupId"),width:"150","show-overflow-tooltip":!0},null,8,["label"]),l(_,{prop:"create_time",label:s(a)("createTime"),width:"250","show-overflow-tooltip":!0},null,8,["label"]),l(_,{prop:"expire_time",label:s(a)("expireTime"),width:"250","show-overflow-tooltip":!0},{default:r(({row:e})=>[e.expire_time==0?(i(),f("div",Ye,"永久")):(i(),f("div",Ne,p(e.expire_time),1))]),_:1},8,["label"]),l(_,{label:s(a)("status"),width:"100",align:"center"},{default:r(({row:e})=>[e.status==1?(i(),h(P,{key:0,class:"ml-2",type:"success"},{default:r(()=>[u(p(e.status_name),1)]),_:2},1024)):e.status==3?(i(),h(P,{key:1,class:"ml-2",type:"error"},{default:r(()=>[u(p(e.status_name),1)]),_:2},1024)):(i(),h(P,{key:2,class:"ml-2",type:"error"},{default:r(()=>[u(p(e.status_name),1)]),_:2},1024))]),_:1},8,["label"]),l(_,{label:s(a)("operation"),"min-width":"250",align:"right",fixed:"right"},{default:r(({row:e})=>[l(d,{type:"primary",link:"",onClick:v=>z(e)},{default:r(()=>[u(" 访问站点 ")]),_:2},1032,["onClick"]),e.status==1||e.status==3?(i(),h(d,{key:0,type:"primary",link:"",onClick:v=>R(e.status,e.site_id)},{default:r(()=>[u(p(e.status==1?s(a)("closeTxt"):s(a)("openTxt")),1)]),_:2},1032,["onClick"])):ae("",!0),l(d,{type:"primary",link:"",onClick:v=>j(e)},{default:r(()=>[u(p(s(a)("edit")),1)]),_:2},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:v=>G(e)},{default:r(()=>[u(p(s(a)("delete")),1)]),_:2},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:v=>M(e)},{default:r(()=>[u(p(s(a)("url")),1)]),_:2},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:v=>N(e)},{default:r(()=>[u(p(s(a)("info")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[J,o.loading]]),c("div",Me,[l(A,{"current-page":o.page,"onUpdate:current-page":t[8]||(t[8]=e=>o.page=e),"page-size":o.limit,"onUpdate:page-size":t[9]||(t[9]=e=>o.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:t[10]||(t[10]=e=>m()),onCurrentChange:m},null,8,["current-page","page-size","total"])])])]),_:1}),l(Ce,{ref_key:"addSiteDialog",ref:x,onComplete:t[11]||(t[11]=e=>m())},null,512)])}}});const ga=ge(je,[["__scopeId","data-v-540b0510"]]);export{ga as default};
