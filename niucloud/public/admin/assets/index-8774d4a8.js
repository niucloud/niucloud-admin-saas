import{c as T}from"./index-3fd412a3.js";import{E as J}from"./index-51305aa3.js";import{b as Q,d as O,a as U,i as v,a1 as X,f as Z}from"./index-2048a34f.js";import{m as ee}from"./typescript-defaf979.js";import{d as V,b as ae,t as te,r as u,c as p,w as le,o as re,e as c,f as m,C as se,u as a,H as d,n as g,h as E,g as P,B as oe,F as ne,v as ie,x as ue,j as ce,_ as de,E as fe,m as ve,l as pe}from"./base-d79f9f62.js";import{u as me}from"./index-6229e0fd.js";import{u as ye}from"./index-b6ca69fd.js";import{i as ge}from"./position-4bcbb4c8.js";import{g as we}from"./scroll-aa5f3aa0.js";const he=Q({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:O([String,Object])},previewSrcList:{type:O(Array),default:()=>ee([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Le={load:s=>s instanceof Event,error:s=>s instanceof Event,switch:s=>U(s),close:()=>!0,show:()=>!0},ke=["src","loading"],Se={key:0},ze=V({name:"ElImage",inheritAttrs:!1}),Ee=V({...ze,props:he,emits:Le,setup(s,{emit:f}){const t=s;let C="";const{t:$}=me(),o=ae("image"),H=te(),M=ye(),w=u(),n=u(!1),i=u(!0),h=u(!1),y=u(),r=u(),F=v&&"loading"in HTMLImageElement.prototype;let L,k;const j=p(()=>H.style),x=p(()=>{const{fit:e}=t;return v&&e?{objectFit:e}:{}}),S=p(()=>{const{previewSrcList:e}=t;return Array.isArray(e)&&e.length>0}),D=p(()=>{const{previewSrcList:e,initialIndex:l}=t;let N=l;return l>e.length-1&&(N=0),N}),b=p(()=>t.loading==="eager"?!1:!F&&t.loading==="lazy"||t.lazy),z=()=>{v&&(i.value=!0,n.value=!1,w.value=t.src)};function R(e){i.value=!1,n.value=!1,f("load",e)}function Y(e){i.value=!1,n.value=!0,f("error",e)}function I(){ge(y.value,r.value)&&(z(),A())}const B=Z(I,200);async function _(){var e;if(!v)return;await fe();const{scrollContainer:l}=t;X(l)?r.value=l:ve(l)&&l!==""?r.value=(e=document.querySelector(l))!=null?e:void 0:y.value&&(r.value=we(y.value)),r.value&&(L=T(r,"scroll",B),setTimeout(()=>I(),100))}function A(){!v||!r.value||!B||(L==null||L(),r.value=void 0)}function q(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function K(){S.value&&(k=T("wheel",q,{passive:!1}),C=document.body.style.overflow,document.body.style.overflow="hidden",h.value=!0,f("show"))}function W(){k==null||k(),document.body.style.overflow=C,h.value=!1,f("close")}function G(e){f("switch",e)}return le(()=>t.src,()=>{b.value?(i.value=!0,n.value=!1,A(),_()):z()}),re(()=>{b.value?_():z()}),(e,l)=>(c(),m("div",{ref_key:"container",ref:y,class:g([a(o).b(),e.$attrs.class]),style:ce(a(j))},[w.value!==void 0&&!n.value?(c(),m("img",se({key:0},a(M),{src:w.value,loading:e.loading,style:a(x),class:[a(o).e("inner"),a(S)&&a(o).e("preview"),i.value&&a(o).is("loading")],onClick:K,onLoad:R,onError:Y}),null,16,ke)):d("v-if",!0),i.value||n.value?(c(),m("div",{key:1,class:g(a(o).e("wrapper"))},[i.value?E(e.$slots,"placeholder",{key:0},()=>[P("div",{class:g(a(o).e("placeholder"))},null,2)]):n.value?E(e.$slots,"error",{key:1},()=>[P("div",{class:g(a(o).e("error"))},oe(a($)("el.image.error")),3)]):d("v-if",!0)],2)):d("v-if",!0),a(S)?(c(),m(ne,{key:2},[h.value?(c(),ie(a(J),{key:0,"z-index":e.zIndex,"initial-index":a(D),infinite:e.infinite,"zoom-rate":e.zoomRate,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:W,onSwitch:G},{default:ue(()=>[e.$slots.viewer?(c(),m("div",Se,[E(e.$slots,"viewer")])):d("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):d("v-if",!0)],64)):d("v-if",!0)],6))}});var Ce=de(Ee,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const Ve=pe(Ce);export{Ve as E};
