import{d as j,r as h,n as z,q as L,N as t,h as v,I as g,w as u,a as T,e as a,i as p,t as i,u as n,y as f,B as A,c as G,F as Z,G as W,z as c,W as X,X as Y,ay as H,az as J,aC as Q,aD as ee,aE as le,Y as ae,E as te,aa as oe,a0 as ue}from"./index-9d601459.js";/* empty css                   *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                        *//* empty css                 */import{_ as ne}from"./index-5380230b.js";/* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 */import"./el-form-item-4ed993c7.js";import{_ as re}from"./select-menu-item.vue_vue_type_script_setup_true_lang-79cfe1ef.js";import{i as de,j as se,k as me}from"./sys-45a56363.js";const pe={class:"input-width"},ie={class:"dialog-footer"},Me=j({__name:"edit-menu",props:{menuTree:{type:Array,default:()=>[]}},emits:["complete"],setup(I,{expose:N,emit:M}){const $=I,b=h(!1),w=h("post"),_=h(!1);let E="";const P={id:0,menu_name:"",menu_type:0,parent_key:"",icon:"",api_url:"",router_path:"",view_path:"",methods:"",sort:"",status:1,is_show:1,menu_key:"",app_type:""},e=z({...P}),k=h(),q=m=>/^([a-zA-Z_$])([a-zA-Z0-9_$])*$/.test(m),x=L(()=>({menu_name:[{required:!0,message:t("menuNamePlaceholder"),trigger:"blur"}],menu_key:[{required:!0,message:t("menuKeyPlaceholder"),trigger:"blur"},{validator:(m,l,r)=>{q(l)||r(new Error(t("menuKeyValidata"))),r()},trigger:"blur"}],router_path:[{required:e.menu_type!=2,message:t("routePathPlaceholder"),trigger:"blur"}],view_path:[{required:e.menu_type==1,message:t("viewPathPlaceholder"),trigger:"blur"}],icon:[{required:e.menu_type!=2,message:t("selectIconPlaceholder"),trigger:"blur"}],api_url:[{required:e.menu_type==2,message:t("selectIconPlaceholder"),trigger:"blur"}]})),B=async m=>{if(_.value||!m)return;const l=e.id?de:se;await m.validate(async(r,d)=>{if(r){_.value=!0;const s=e;s.api_url=s.api_url?`${s.api_url}/${w.value}`:"",l(s).then(V=>{_.value=!1,b.value=!1,M("complete")}).catch(()=>{_.value=!1})}})};return N({showDialog:b,setFormData:async(m=null)=>{if(_.value=!0,Object.assign(e,P),E=t("addMenu"),m.menu_key){E=t("updateMenu");const l=await(await me(m.menu_key)).data;Object.keys(e).forEach(r=>{l[r]!=null&&(e[r]=l[r])})}else Object.keys(e).forEach(l=>{m[l]!=null&&(e[l]=m[l])});_.value=!1}}),(m,l)=>{const r=X,d=Y,s=H,V=J,y=Q,U=ee,F=ne,C=le,S=ae,D=te,K=oe,O=ue;return v(),g(K,{modelValue:b.value,"onUpdate:modelValue":l[14]||(l[14]=o=>b.value=o),title:n(E),width:"500px","destroy-on-close":!0},{footer:u(()=>[T("span",ie,[a(D,{onClick:l[12]||(l[12]=o=>b.value=!1)},{default:u(()=>[p(i(n(t)("cancel")),1)]),_:1}),a(D,{type:"primary",loading:_.value,onClick:l[13]||(l[13]=o=>B(k.value))},{default:u(()=>[p(i(n(t)("confirm")),1)]),_:1},8,["loading"])])]),default:u(()=>[f((v(),g(S,{model:e,"label-width":"90px",class:"page-form",ref_key:"formRef",ref:k,rules:n(x)},{default:u(()=>[a(d,{label:n(t)("menuName"),prop:"menu_name"},{default:u(()=>[a(r,{modelValue:e.menu_name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.menu_name=o),placeholder:n(t)("menuNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e.id?A("",!0):(v(),g(d,{key:0,label:n(t)("menuKey"),prop:"menu_key"},{default:u(()=>[a(r,{modelValue:e.menu_key,"onUpdate:modelValue":l[1]||(l[1]=o=>e.menu_key=o),placeholder:n(t)("menuKeyPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),a(d,{label:n(t)("menuType")},{default:u(()=>[a(V,{modelValue:e.menu_type,"onUpdate:modelValue":l[2]||(l[2]=o=>e.menu_type=o)},{default:u(()=>[a(s,{label:0},{default:u(()=>[p(i(n(t)("menuTypeDir")),1)]),_:1}),a(s,{label:1},{default:u(()=>[p(i(n(t)("menuTypeMenu")),1)]),_:1}),a(s,{label:2},{default:u(()=>[p(i(n(t)("menuTypeButton")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(d,{label:n(t)("parentMenu"),prop:"parent_key"},{default:u(()=>[a(U,{modelValue:e.parent_key,"onUpdate:modelValue":l[3]||(l[3]=o=>e.parent_key=o),placeholder:"Select",class:"input-width"},{default:u(()=>[a(y,{label:n(t)("topLevel"),value:""},null,8,["label"]),(v(!0),G(Z,null,W($.menuTree,(o,R)=>(v(),g(re,{menu:o,key:R},null,8,["menu"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),f(a(d,{label:n(t)("routePath"),prop:"router_path"},{default:u(()=>[a(r,{modelValue:e.router_path,"onUpdate:modelValue":l[4]||(l[4]=o=>e.router_path=o),placeholder:n(t)("routePathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[c,e.menu_type!=2]]),f(a(d,{label:n(t)("viewPath"),prop:"view_path"},{default:u(()=>[a(r,{modelValue:e.view_path,"onUpdate:modelValue":l[5]||(l[5]=o=>e.view_path=o),placeholder:n(t)("viewPathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[c,e.menu_type==1]]),f(a(d,{label:n(t)("authId"),prop:"api_url"},{default:u(()=>[a(r,{modelValue:e.api_url,"onUpdate:modelValue":l[7]||(l[7]=o=>e.api_url=o),placeholder:n(t)("authIdPlaceholder"),class:"input-width"},{append:u(()=>[a(U,{class:"w-[90px] border-none",modelValue:w.value,"onUpdate:modelValue":l[6]||(l[6]=o=>w.value=o)},{default:u(()=>[a(y,{label:"POST",value:"post"}),a(y,{label:"GET",value:"get"}),a(y,{label:"PUT",value:"put"}),a(y,{label:"DELETE",value:"delete"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),[[c,e.menu_type!=0]]),f(a(d,{label:n(t)("menuIcon"),prop:"icon"},{default:u(()=>[T("div",pe,[a(F,{modelValue:e.icon,"onUpdate:modelValue":l[8]||(l[8]=o=>e.icon=o)},null,8,["modelValue"])])]),_:1},8,["label"]),[[c,e.menu_type!=2]]),f(a(d,{label:n(t)("status")},{default:u(()=>[a(V,{modelValue:e.status,"onUpdate:modelValue":l[9]||(l[9]=o=>e.status=o)},{default:u(()=>[a(s,{label:1},{default:u(()=>[p(i(n(t)("statusNormal")),1)]),_:1}),a(s,{label:0},{default:u(()=>[p(i(n(t)("statusDeactivate")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[c,e.menu_type!=2]]),f(a(d,{label:n(t)("isShow")},{default:u(()=>[a(V,{modelValue:e.is_show,"onUpdate:modelValue":l[10]||(l[10]=o=>e.is_show=o)},{default:u(()=>[a(s,{label:1},{default:u(()=>[p(i(n(t)("show")),1)]),_:1}),a(s,{label:0},{default:u(()=>[p(i(n(t)("hidden")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[c,e.menu_type!=2]]),a(d,{label:n(t)("sort")},{default:u(()=>[a(C,{modelValue:e.sort,"onUpdate:modelValue":l[11]||(l[11]=o=>e.sort=o),min:0},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[O,_.value]])]),_:1},8,["modelValue","title"])}}});export{Me as _};
