import{d as Z,r as b,n as W,q as X,N as o,h as f,I as v,w as n,a as T,e as a,i as m,t as p,u,y as c,B as Y,c as H,F as J,G as Q,z as y,W as ee,X as le,ay as ae,az as te,as as oe,aE as ne,aF as ue,aG as de,Y as se,E as re,aa as me,$ as pe}from"./index-4ce69858.js";/* empty css                   *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                        *//* empty css                 */import{_ as ie}from"./index-79face66.js";/* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                *//* empty css                    *//* empty css                       *//* empty css                 */import"./el-form-item-4ed993c7.js";import{k as _e,l as ce,m as fe,n as ye,o as be}from"./sys-e410b79c.js";import{g as ve}from"./tools-5de7422d.js";const Ve={class:"input-width"},he={class:"dialog-footer"},Re=Z({__name:"edit-menu",emits:["complete"],setup(ge,{expose:x,emit:I}){const V=b(!1),i=b(!1);let w="";const U={id:0,menu_name:"",menu_type:0,parent_key:"",icon:"",api_url:"",router_path:"",view_path:"",methods:"post",sort:"",status:1,is_show:1,menu_key:"",app_type:"",addon:"",menu_short_name:""},e=W({...U}),k=b([]),E=b([]),P=b([]),M=b(),B=d=>/^([a-zA-Z_$])([a-zA-Z0-9_$])*$/.test(d),C=X(()=>({menu_name:[{required:!0,message:o("menuNamePlaceholder"),trigger:"blur"}],menu_key:[{required:!0,message:o("menuKeyPlaceholder"),trigger:"blur"},{validator:(d,l,s)=>{B(l)||s(new Error(o("menuKeyValidata"))),s()},trigger:"blur"}],router_path:[{required:e.menu_type!=2,message:o("routePathPlaceholder"),trigger:"blur"}],view_path:[{required:e.menu_type==1,message:o("viewPathPlaceholder"),trigger:"blur"}],api_url:[{required:e.menu_type==2,message:o("authIdPlaceholder"),trigger:"blur"}]})),q=async()=>{const{data:d}=await ve({});k.value=[{title:"系统",key:""}],k.value.push(...d)},A=async()=>{const{data:d}=await ye();E.value=[{menu_name:"顶级",menu_key:""}],E.value.push(...d)},D=async d=>{const{data:l}=await be(d);P.value=l},L=async d=>{e.parent_key="",d!=""&&(await D(d),e.parent_key=P.value[0].menu_key)},$=async d=>{if(i.value||!d)return;const l=e.id?_e:ce;await d.validate(async(s,r)=>{s&&(i.value=!0,l(e).then(g=>{i.value=!1,V.value=!1,I("complete")}).catch(()=>{i.value=!1}))})};return x({showDialog:V,setFormData:async(d=null)=>{if(i.value=!0,Object.assign(e,U),w=o("addMenu"),q(),A(),d.menu_key){w=o("updateMenu");const l=await(await fe(d.app_type,d.menu_key)).data;Object.keys(e).forEach(s=>{l[s]!=null&&(e[s]=l[s])}),e.addon!=""&&D(e.addon)}else Object.keys(e).forEach(l=>{d[l]!=null&&(e[l]=d[l])});i.value=!1}}),(d,l)=>{const s=ee,r=le,_=ae,g=te,h=oe,N=ne,F=ue,K=ie,O=de,R=se,S=re,z=me,G=pe;return f(),v(z,{modelValue:V.value,"onUpdate:modelValue":l[17]||(l[17]=t=>V.value=t),title:u(w),width:"500px","destroy-on-close":!0},{footer:n(()=>[T("span",he,[a(S,{onClick:l[15]||(l[15]=t=>V.value=!1)},{default:n(()=>[m(p(u(o)("cancel")),1)]),_:1}),a(S,{type:"primary",loading:i.value,onClick:l[16]||(l[16]=t=>$(M.value))},{default:n(()=>[m(p(u(o)("confirm")),1)]),_:1},8,["loading"])])]),default:n(()=>[c((f(),v(R,{model:e,"label-width":"90px",class:"page-form",ref_key:"formRef",ref:M,rules:u(C)},{default:n(()=>[a(r,{label:u(o)("menuName"),prop:"menu_name"},{default:n(()=>[a(s,{modelValue:e.menu_name,"onUpdate:modelValue":l[0]||(l[0]=t=>e.menu_name=t),placeholder:u(o)("menuNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e.id?Y("",!0):(f(),v(r,{key:0,label:u(o)("menuKey"),prop:"menu_key"},{default:n(()=>[a(s,{modelValue:e.menu_key,"onUpdate:modelValue":l[1]||(l[1]=t=>e.menu_key=t),placeholder:u(o)("menuKeyPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),a(r,{label:u(o)("menuType")},{default:n(()=>[a(g,{modelValue:e.menu_type,"onUpdate:modelValue":l[2]||(l[2]=t=>e.menu_type=t)},{default:n(()=>[a(_,{label:0},{default:n(()=>[m(p(u(o)("menuTypeDir")),1)]),_:1}),a(_,{label:1},{default:n(()=>[m(p(u(o)("menuTypeMenu")),1)]),_:1}),a(_,{label:2},{default:n(()=>[m(p(u(o)("menuTypeButton")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),c(a(r,{label:u(o)("addon"),prop:"addon"},{default:n(()=>[a(N,{modelValue:e.addon,"onUpdate:modelValue":l[3]||(l[3]=t=>e.addon=t),placeholder:"Select",class:"input-width",onChange:L},{default:n(()=>[(f(!0),H(J,null,Q(k.value,(t,j)=>(f(),v(h,{label:t.title,value:t.key,key:j},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[y,e.app_type=="site"]]),a(r,{label:u(o)("parentMenu"),prop:"parent_key"},{default:n(()=>[e.addon!=""?(f(),v(F,{key:0,class:"input-width",modelValue:e.parent_key,"onUpdate:modelValue":l[4]||(l[4]=t=>e.parent_key=t),props:{label:"menu_name",value:"menu_key"},data:P.value,"check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])):(f(),v(F,{key:1,class:"input-width",modelValue:e.parent_key,"onUpdate:modelValue":l[5]||(l[5]=t=>e.parent_key=t),props:{label:"menu_name",value:"menu_key"},data:E.value,"check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"]))]),_:1},8,["label"]),c(a(r,{label:u(o)("routePath"),prop:"router_path"},{default:n(()=>[a(s,{modelValue:e.router_path,"onUpdate:modelValue":l[6]||(l[6]=t=>e.router_path=t),placeholder:u(o)("routePathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[y,e.menu_type!=2]]),c(a(r,{label:u(o)("viewPath"),prop:"view_path"},{default:n(()=>[a(s,{modelValue:e.view_path,"onUpdate:modelValue":l[7]||(l[7]=t=>e.view_path=t),placeholder:u(o)("viewPathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[y,e.menu_type==1]]),c(a(r,{label:u(o)("authId"),prop:"api_url"},{default:n(()=>[a(s,{modelValue:e.api_url,"onUpdate:modelValue":l[9]||(l[9]=t=>e.api_url=t),placeholder:u(o)("authIdPlaceholder"),class:"input-width"},{append:n(()=>[a(N,{class:"w-[90px] border-none",modelValue:e.methods,"onUpdate:modelValue":l[8]||(l[8]=t=>e.methods=t)},{default:n(()=>[a(h,{label:"POST",value:"post"}),a(h,{label:"GET",value:"get"}),a(h,{label:"PUT",value:"put"}),a(h,{label:"DELETE",value:"delete"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),[[y,e.menu_type!=0]]),c(a(r,{label:u(o)("menuIcon"),prop:"icon"},{default:n(()=>[T("div",Ve,[a(K,{modelValue:e.icon,"onUpdate:modelValue":l[10]||(l[10]=t=>e.icon=t)},null,8,["modelValue"])])]),_:1},8,["label"]),[[y,e.menu_type!=2]]),c(a(r,{label:u(o)("status")},{default:n(()=>[a(g,{modelValue:e.status,"onUpdate:modelValue":l[11]||(l[11]=t=>e.status=t)},{default:n(()=>[a(_,{label:1},{default:n(()=>[m(p(u(o)("statusNormal")),1)]),_:1}),a(_,{label:0},{default:n(()=>[m(p(u(o)("statusDeactivate")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[y,e.menu_type!=2]]),c(a(r,{label:u(o)("isShow")},{default:n(()=>[a(g,{modelValue:e.is_show,"onUpdate:modelValue":l[12]||(l[12]=t=>e.is_show=t)},{default:n(()=>[a(_,{label:1},{default:n(()=>[m(p(u(o)("show")),1)]),_:1}),a(_,{label:0},{default:n(()=>[m(p(u(o)("hidden")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[y,e.menu_type!=2]]),a(r,{label:u(o)("menuShortName")},{default:n(()=>[a(s,{modelValue:e.menu_short_name,"onUpdate:modelValue":l[13]||(l[13]=t=>e.menu_short_name=t),placeholder:u(o)("menuShortNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(r,{label:u(o)("sort")},{default:n(()=>[a(O,{modelValue:e.sort,"onUpdate:modelValue":l[14]||(l[14]=t=>e.sort=t),min:0},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[G,i.value]])]),_:1},8,["modelValue","title"])}}});export{Re as _};
